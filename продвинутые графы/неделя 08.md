# гамильтоновы циклы

Гамильтонов граф — это граф, в котором есть гамильтонов цикл.

Гамильтонов цикл — цикл, проходящий через каждую вершину графа ровно по одному разу.
![[Pasted image 20230614214527.png|w50]]
В отличие от эйлеровых циклов, пока нет ни хороших критериев гамильтоновости, ни быстрых алгоритмов построения гамильтоновых циклов.

Есть некоторые достаточные условия существования гамильтоновых циклов.

## теорема Хватала-Эрдёша

Если число независимости графа не превосходит числа вершинной связности $\alpha(G)\le \kappa(G)$, то граф $G$ гамильтонов.

$\alpha(G)$ — число независимости графа (размер максимального независимого множества)
$\kappa(G)$ — число вершинной связности (минимальное число вершин, удаление которых позволяет сделать граф несвязным)

### доказательство

Допустим, что $G$ не гамильтонов и покажем, что в этом случае $\alpha(G)>\kappa(G)$.

Рассмотрим цикл $C$ в $G$, имеющий максимальную длину.
По предположению $V(C)\ne V(G)$.

Пусть $B\subset C$  — одна из компонент связности (возможно единственная) графа $(G-C)$.

Так как $G$ связный, то есть ребра между $B$ и $C$.
![[Pasted image 20230614215254.png|w50]]
Пусть $C_B$ — вершины $C$, смежные с $B$, и пусть $C_B^+$ — вершины цикла $C$, «следующие» за вершинами из $C_B$ (в некоторой ориентации $C$).
![[Pasted image 20230614215518.png|w50]]
Удаление из $G$ всех вершин, входящих в $C_B$, нарушает связность $G$, поэтому число вершинной связности точно не превосходит мощности какого-то множества, удаление которого позволяет получить несвязный граф
$$\kappa(G)\le|C_B|=|C_B^+|$$
Вершины из $C_B^+$ не смежны между собой, так как иначе цикл $C$ можно было бы увеличить
![[Pasted image 20230614215952.png|w70]]
Также, между $C_B^+$ и $B$ ребер нет, иначе длину цикла можно было бы увеличить
![[Pasted image 20230614220127.png|w70]]
Следовательно, если к $C_B^+$ добавить любую вершину из $B$, получится независимое множество размера $(|C_B^+|+1)$ в $G$.

Получается, что число независимости графа $G$ никак не меньше, чем число одного конкретного из независимых множеств
$$\alpha(G)>|C_B^+|\ge \kappa(G)$$
что и требовалось.

## теорема Suil O, Douglas B. West, Hehui Wu

Если $\alpha(G)\ge\kappa(G)$, то в $G$ есть цикл, длина которого не меньше
$$\frac{\kappa(|G|+\alpha-\kappa)}{\alpha}$$
(при $\alpha=\kappa$ получаем гамильтоновость)

## теорема Асратяна-Хачатряна

Пусть граф $G$ **связен** и пусть для любой тройки $u,v,w\in V(G)$, такой, что $uv,wv \in V(G)$ и $uw\ne V(G)$ выполнено неравенство
$$d(u)+d(w)\ge|N(u)\cup N(v) \cup N(w)|$$
тогда граф гамильтонов.

$d$ — это степень вершины
$N$ — это окрестность вершины
![[Pasted image 20230614221353.png|w60]]

### доказательство

Для любой порожденной цепи $uvw$ выполнены неравенства
$$\begin{aligned}
|N(u)\cap N(w)| &= d(u) + d(w) - |N(u)\cup N(w)|\ge \\
&\ge |N(u)\cup N(v) \cup N(w)| - |N(u) \cup N(w)| =\\
&= |N(v)|-\big|N(v)\cap\big(N(u)\cup N(w)\big)\big|=\\
&= \big|N(v)\backslash\big(N(u)\cup N(w)\big)\big|=\big|N(v)\backslash N\big(\{u,w\}\big)\big|
\end{aligned}$$
В частности
$$|N(u)\cap N(w)|\ge|\{u,w\}|=2$$
следовательно в $G$ есть циклы.

Пусть $C$ — максимальный простой цикл в $G$.

Предположим, что $V(G)\backslash V(C)\ne\varnothing$ и придем к противоречию.

Предположим, что есть некоторая вершина вне цикла $x\in V(G-C)$ и возьмем ее так, что она к циклу ближайшая и из нее есть ребра в цикл $N(x)\cup V(C)\ne\varnothing$.

Зафиксируем некоторую ориентацию цикла $C$. 

Положим множество вершин, соединенных с $x$, $C_x := V(C)\cap N(x)$, и пусть $C_x^+$ — множество «последователей» вершин из $C_x$ на цикле $C$
![[Pasted image 20230615190948.png|w50]]
Из максимальности $C$ следует, что $C_x\cap C_x^+ = \varnothing$

Кроме того, никакая пара вершин из $\{x\} \cup C_x^+$ не смежна:

![[Pasted image 20230615191608.png|w75]]
Более того, никакая пара вершин из $\{x\}\cup C_x^+$ не имеет общих соседей вне цикла $C$:

![[Pasted image 20230615191803.png|w80]]

Никакие две вершины из $\{x\}\cup C_x^+$ не смежны, а значит порожденной цепью в $G$ является каждая тройка вершин $xyy^+$, где $y\in C_x$ и $y^+\in C_x^+$ ($y^+$ — последователь $y$ на цикле $C$).

Тогда $|N(x)\cap N(y^+)|\ge \big|N(y)\backslash\big(\{x,y^+\}\big)\big|$

Так как $(C_x^+\cup \{x\}) \cap (N(\{x,y^+\})=\varnothing$, то
$$|N(y)\backslash N(\{x,y^+\})|\ge|N(y)\cap (C_x^+ \cup\{x\})|= |N(y)\cap C_x^+|+1$$
Отсюда для каждой тройки $xyy^+$
$$|N(y)\cap C_x^+|\le |N(x)\cap N(y^+)|-1$$
Пусть $||C_x,C_x^+||$ — число ребер $G$, соединяющих вершины из $C_x$ и $C_x^+$. Получаем
$$\begin{aligned}
||C_x,C_x^+|| &= \sum_{y\in C_x}|N(y)\cap C^+_x|\le \\
&\le \sum_{y\in C_x} (|N(x)\cap N(y^+)|-1) = \\
&= -|C_x|+\sum_{y\in C_x}|N(x)\cap N(y^+)|
\end{aligned}$$
Никакие две вершины из $\{x\}\cup C_x^+$ не имеют общих соседей вне $C$, поэтому
$$N(x)\cap N(y^+)=C_x\cap N(y^+)$$
Отсюда
$$\begin{aligned}
||C_x,C_x^+|| &\le -|C_x|+\sum_{y\in C_x}|N(x)\cap N(y^+)|=\\
& = -|C_x|+\sum_{y\in C_x}|C_x\cap N(y^+)|=\\
&= -|C_x|+||C_x,C_x^+||
\end{aligned}$$
— противоречие.

## теорема Оре

Если для любых несмежных $u,v\in V(G)$ выполнено неравенство 
$$d(u)+d(v)\ge |G|$$
то граф $G$ — гамильтонов.

## теорема Дирака

Если
$$\delta(G)\ge \frac{|G|}{2}$$
то граф гамильтонов.

## гамильтоновы последовательности

**Степенной последовательностью** графа $G$ называется набор чисел $\{d(v)_{v\in V(G)}\}$ (степеней вершин этого графа), упорядоченный по возрастанию.

Последовательностью чисел $a_1\le a_2 \le \ldots a_n$ называется **гамильтоновой**, если гамильтоновым является любой граф $G$, такой, что его степенная последовательность $\{d_i\}^n_{i=1}$ удовлетворяет условиям $d_1\ge a_1, \ldots, d_n\ge a_n$.

## теорема Хватала

Последовательность $0\le a_1 \le\ldots\le a_n\le n$ гамильтонова, если и только если для каждого $k\in[1, n/2)$ выполнено условие:
$$a_k \le k \Rightarrow a_{n-k}\ge n-k$$
если $k$ элемент оказывается $\le k$, то симметричный относительно центра элемент $(n-k)$ должен быть $\ge (n-k)$

То есть малость элементов в начале последовательности приходится компенсировать великостью элементов в конце последовательности.

### доказательство

**доказательство необходимости**

Допустим, для некоторого $k<n/2$ условия нарушены, то есть $a_k \le k$ и $a_{n-k}\le n-k-1$

Построим негамильтонов граф $G$ со следующей степенной последовательностью:
$$\begin{aligned}
d_1 &= \cdots=d_k:=k \\
d_{k+1} & =\cdots=d_{n-k}:=n-k-1 \\
d_{n-k+1} &=\cdots=d_n:=n-1
\end{aligned}$$
Очевидно,  для любого $i$ $d_i\ge a_i$.

Граф будет выглядеть вот так:
![[Pasted image 20230615203908.png|w50]]

Полный двудольный граф на вершинах $v_1,\ldots, v_k; v_{n-k+1},\ldots, v_n$, клика на вершинах $v_{k+1},\ldots, v_n$.

Никакой простой цикл в $G$ не может содержать одновременно вершины $v_1,\ldots, v_k; v_{n-k+1},\ldots, v_n$ и $v_{k+1}$.

**доказательство достаточности**

Допустим, что нашелся негамильтонов граф, удовлетворяющий условиям Хватала:
$$\forall k<\frac{n}{2} \ (a_k \le k \Rightarrow a_{n-k}\ge n-k)$$
Добавление ребер в граф не нарушает условий Хватала. Будем добавлять в наш граф ребра, пока не получим граф $G$, такой, что
- $G$ удовлетворяет условиям Хватала
- $G$ негамильтонов
- $(G+xy)$ гамильтонов для любых $x,y \in V(G)$, таких, что $xy\notin E(G)$

Выберем в $G$ пару несмежных вершин $x,y$ таких, что $d(x)\le d(y)$ и что сумма $d(x)+d(y)$ максимально возможная.

В $G$ есть гамильтонов путь из $x$ в $y$:
![[Pasted image 20230615210008.png|w75]]
Вершина $y$ не может быть смежна с «левыми соседями» вершин $N(x)$, иначе в $G$ был бы гамильтонов цикл.

Поэтому $d(y)\le n-1-d(x)$, то есть $d(x)+d(y)<n$.

Положим $k:= d(x)< n/2$

Так как $|V(G)\backslash N(y)|\ge d(x)=k$ и $\big(d(x)+d(y)\big)$ максимальна, то количество вершин графа $G$ степени не выше $k$ по крайней мере $k$:
$$\big|\{v\in V(G)|d(v)\le k\}\big|\ge k$$
потому что в графе много вершин, не смежных с $y$ (их по крайней мере $k$) и у каждой из них степень не превосходит $k$. Одной из таких вершин является сама вершина $x$.

Значит в степенной последовательности графа $G$ имеем по крайней мере $k$ вершин имеют степень не выше $k$: $d_1\le k,\ldots, d_k\le k$. Следовательно,
$$d_{n-k}\ge n-k, \ldots,d_n\ge n-k$$
Отсюда количество вершин графа $G$ у которых большая степень не меньше, чем $k+1$: $|\{v \in V(G)| d(v)\ge n-k\}|\ge k+1 > d(x)$ и найдется вершина $z\in V(G)\backslash N(x)$ такая, что $d(z)\ge n-k$.

Но тогда $d(x)+d(z)\ge n > d(x)+d(y)$ — противоречие.в

## гамильтоновость и связность

Каждый гамильтонов граф двусвязен.

Для любого $k$ существуют $k$-связные негамильтоновы графы.

Существуют негамильтоновы планарные трехсвязные графы. Из можно найти даже среди триангуляций

Для следующего графа $\alpha(G)=6$ и $|G|=11$, в то время, как у гамильтоновых графов $\alpha(G)\le |G|/2$:
![[Pasted image 20230616004020.png|w50]]
## теорема Татта

Каждый 4-связный планарный граф является гамильтоновым.

## теорема Whitney

Если $G$ триангуляция, и если в $G$ каждый цикл длины 3 ограничивает некоторую грань, то $G$ является гамильтоновым.

## теорема Татта

Планарность + трехсвязность + регулярность тоже не гарантируют гамильтоновости.

Пример графа (граф Гринбергса)
![[Pasted image 20230616004349.png|w50]]
## теорема Гринбергса

Для любой укладки планарного гамильтонова графа $G$ и для любого гамильтонова цикла $C$ выполняется соотношение
$$\sum_{k=1}^{|G|}(k-2)f^{\inf}_k=\sum_{k=1}^{|G|}(k-2)f^{\text{ext}}_k=|G|-2$$
где $f^{\inf}_k$ и $f^{\text{ext}}_k$ — число граней периметра $k$, лежащих внутри и вне гамильтонова цикла $C$ соответственно.

### доказательство

Пусть $E_{int}$ — множество ребер графа $G$, попадающих внутрь цикла $C$.

Пусть $F_{int}$ — грани, лежащие внутри $C$.

Заметим, что выполнено равенство
$$|F_{int}|=|E_{int}|+1$$
![[Pasted image 20230616004638.png|w50]]
Каждое ребро из $E_{int}$ ограничивает две грани из $F_{int}$, а каждое ребро в $C$ лежит на границе ровно одной грани из $F_{int}$,  поэтому сумма периметров всех граней $F_{int}$ равна
$$\begin{aligned}
|E(C)|+2|E_{int}| &= |G|+2(|F_{int}|-1) = \\
&=|G|-2 + 2\cdot \sum_{k=1}^nf_k^{int}
\end{aligned}$$
С другой стороны, та же сумма периметров равна 
$$\sum_{k=1}^nk\cdot f_k^{int}$$
Получаем
$$\sum_{k=1}^n k\cdot f_{k}^{int}=|G|-2+2\cdot \sum_{k=1}^nf_k^{int}$$
отсюда
$$\sum_{k=1}^n(k-2)\cdot f_k^{int}=|G|-2$$
Второе равенство из утверждения теоремы доказывается точно так же.

### следствие из теоремы Гринбергса

Граф Гринбергса негамильтонов.

#### доказательство

Из теоремы следует, что для гамильтонова графа должно быть выполнено
$$\sum_{k=1}^n(k-2)\cdot(f^{int}_k-f_k^{ext})=0$$
В графе Гринбергса грани имеют периметры 4, 5 и 8, поэтому для него нулю равнялась бы сумма:
$$2(f^{int}_4-f_4^{ext})+3(f^{int}_5-f_5^{ext})+6(f^{int}_8-f_8^{ext})$$
из этого следует, что $2(f^{int}_4-f_4^{ext})$ делится на 3.

Но в графе Гринбергса только одна грань периметра 4 (внешняя), поэтому
$$2(f^{int}_4-f_4^{ext})\in \{2, -2\}$$
получаем противоречие. Следовательно, граф Гринбергса негамильтонов.