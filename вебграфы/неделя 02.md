# "модель" Барабаши-Альберт

- Зафиксируем начальный граф $G_0$.
- Добавляем вершины одну за другой с исходящими из них ребрами.
- Каждая новая вершина добавляется вместе с $m$ исходящими из нее ребрами, которые соединяют эту вершину с $m$ различными вершинами с вероятностями, пропорциональными степеням этих вершин.
- Это идея *предпочтительного присоединения*: новый сайт, появляясь на свет, предпочтет сослаться на сайт, у которого и так высокий индекс цитирования.
- Очевидно, имеет место разреженность: в графе $n$ вершин и $mn$ ребер.
- Утверждалось, что граф в этой модели имеет малый диаметр, а степени вершин подчиняются степенному закону распределения.

**Критика модели:**
- Случайный граф сильно зависит от начального графа $G_0$.
- В описании модели ничего не сказано про то, как распределено множество концов исходящих из новой вершины ребер среди всех $m$-элементных подмножеств множества остальных вершин.
- Б. Боллобаш и О. Риордан доказали, что весь процесс можно организовать таким образом (выбрав граф $G_0$ и распределение концов ребер), что в полученном случайном графе будет произвольное наперед заданное число треугольников.
- Таким образом, одной четкой модели нет, есть класс моделей.

## модель Боллобаша-Риордана

Построим случайный граф $G_m^n$ с $n$ вершинами и $mn$ ребрами, $m\in \mathbb{N}$. То есть, $m$ — это параметр, отвечающий за отношение числа ребер к числу вершин. Это параметр разреженности.

Пусть $\deg_G(v)$ — степень вершины $v$ в графе $G$.

**Случай $m=1$**

$G_1^1$ — граф с единственной вершиной $v_1$ и петлей в ней.

Пусть граф $G_1^{n-1}$ с $n-1$ вершинами $\{v_1, \ldots, v_{n-1}\}$ и $n-1$ ребрами построен. Построим граф $G_1^m$ добавлением вершины $v_n$ и одного исходящего из нее ребра в вершину $v_i$, выбранную из множества $\{v_1, \ldots, v_{n-1}\}$ с вероятностью:
$$P(i=s)=\begin{cases}
\frac{\deg_{G_1^{n-1}}(v_s)}{2n-1}, & 1\le s\le n-1 \\
\frac{1}{2n-1}, &s=n
\end{cases}$$
$2n-1$ — нормирующий множитель. В графе степень вершин в сумме равна удвоенному количеству ребер. То есть, если просуммировать все вероятности, которые присутствуют в определении, указанном выше, то окажется, что в числителе просуммированы все степени вершин графа, у которого $n-1$ вершина и $n-1$ ребро. Тогда сумма степеней этого графа будет равна $2n-2$.  Если добавить 1 ребро, которое мы добавляем вместе с вершиной, то в итоге получается единица.

**Случай $m>1$**

Граф $G_m^n$ получается из $G_1^{mn}$ склейкой вершин $\{v_1,\ldots,v_m\}$ в новую вершину $v'_1$, вершин $\{v_{m+1},\ldots, v_{2m}\}$ — в $v_2'$, и т. д. 

Граф $G_1^{mn}$ — это граф, в случае, когда $m=1$. Нижняя единица указывает на то, что у него количество ребер равно количеству вершин, а верхний индекс — на то, что и ребер, и вершин в точности $mn$ штук.

Склеенных вершин получится $n$ штук. При склейке все ребра сохраняются.

Например, граф $G_1^8$ и $m=2$:
![[вебграфы/images/неделя 02.png|w60]]
## статическое определение

Линейная хордовая диаграмма. Поставим числа $1,2,\ldots,2n$ на прямую и в верхней полуплоскости соединим пары этих чисел дугами так, чтобы у дуг были разные концы и свободных концов не оставалось
![[вебграфы/images/неделя 02-1.png]]
Иначе говоря, мы берем произвольное неупорядоченное разбиение множества наших чисел на $n$ непересекающихся пар, и каждой паре в разбиении сопоставляем дугу.

Всего таких разбиений
$$\frac{(2n)!}{n!2^n}$$
Строим граф на $n$ вершинах под данной диаграмме. Двигаемся вдоль диаграммы слева направо, пока не встретим правый конец $i_1$ какой-нибудь дуги. Называем вершиной $v_1$ графа группу чисел $\{1, \ldots, i_1\}$. Аналогично находим второй правый конец $i_2$ некоторой дуги и полагаем $v_2=\{i_1+1, \ldots,i_2\}$. И так далее. В итоге возникает $n$ вершин $v_1, \ldots, v_n$:
![[вебграфы/images/неделя 02-2.png]]
Ребро соединяет $v_i$ с $v_j$ тогда и только тогда, когда между соответствующими группами есть дуга.
![[вебграфы/images/неделя 02-3.png]]

## теорема

Пусть $m\ge 2$, $G_m^n$ — случайный граф в модели Боллобаша-Риордана, тогда с вероятностью, стремящейся к единице при $n\to\infty$
$$\text{diam }G_m^n\sim\frac{\ln n}{\ln \ln n}$$
Это означает, что, если зафиксировать произвольное сколь угодно маленькое число $\varepsilon>0$, то с вероятностью, стремящейся к единице, случайная величина, которая определяется, как диаметр случайного графа, заключена в пределах между $(1-\varepsilon)\cdot\frac{\ln n}{\ln \ln n}$ и $(1+\varepsilon)\cdot\frac{\ln n}{\ln \ln n}$


Для реальных значений $n$ получим:
$$\frac{\ln n}{\ln\ln n}\in[5, 15]$$
При $n=2\cdot 10^7$ (Барабаши-Альберт) получается 5.96.

## устойчивость

### теорема

Пусть $m\ge 2$, $G_m^n$ — случайный граф в модели Боллобаша-Риордана, а $p\in[0,1)$ — фиксированное число. Пусть $G_{m,p}^n$ — случайный граф, полученный из $G_m^n$ удалением каждой вершины с вероятностью $p$ независимо от остальных вершин. Тогда существует такая константа $c=c(m,p)$, что с вероятностью, стремящейся к единице при $n\to\infty$, в $G_{m,p}^n$ есть ровно одна компонента размера $(c+o(1))n$.

## уязвимость

### теорема

Пусть $m\ge2$, $G_m^n$ — случайный граф в модели Боллобаша-Риордана, а $c\in(0,1)$ — фиксированное число. Пусть $G_{m,c}^n$ — случайный граф, полученный из $G_m^n$ удалением первых $[cn]$ вершин. Положим
$$c_m^\ast=\frac{m-1}{m+1}$$
Тогда при $c<c_m^\ast$ с вероятностью стремящейся к единице при $n\to\infty$, в $G_{m,c}^n$ есть гигантская компонента. Если же $c>c_m^\ast$, то с вероятностью, стремящейся к единице, при $n\to \infty$, в $G_{m,c}^n$ гигантской компоненты нет.

## распределение степеней вершин

### теорема

Пусть $m\ge 1$, $G_m^n$ — случайный граф в модели Боллобаша-Риордана. Тогда для любого $d\le n^{1/15}$ с вероятностью, стремящейся к единице, при $n\to \infty$:
$$\frac{|\{v\in G_m^n: \deg v=d\}|}{n}\sim\frac{2m(m+1)}{d(d+1)(d+2)}$$
В левом числителе стоит количество вершин графа $G_m^n$, имеющих степень $d$.

Случайный граф Боллобаша-Риордана подчиняется степенному закону: с вероятностью, стремящейся к единице при $n\to\infty$, доля вершин степени $d$  в этом графе примерно равна
$$\frac{2m(m+1)}{d^3}$$
Но показатель степенного закона равен 3 и отличается от ожидаемой величины $\gamma\in(2,3)$. Модель варьировать его не позволяет.

Ограничение $d\le n^{1/15}$ нереалистическое.

## теорема Гречникова

Пусть $m\ge 1$, $G_m^n$ — случайный граф в модели Боллобаша-Риордана. Пусть $\mathbb{I}(A)$ — индикатор свойства $A$, то есть, $\mathbb{I}(A)=1$, если $A$ верно, и $\mathbb{I}(A)=0$ иначе. Тогда для любого $d$:
$$\mathbb{E}|\{v\in G_m^n: \deg v=d\}|=\mathbb{I}(d\ge m)\frac{(2mn+1)(m+1)}{d(d+1)(d+2)}-\frac{\mathbb{I}(d=m)}{m}+O_m\bigg(\frac{d}{n}\bigg)$$

## модель Бакли-Остгуса

В модели Боллобаша-Риордана степенной закон не соответствует реальному вебу. Следующая модель ее обобщает. Пусть $a>0$ — параметр модели. Он называется *начальной притягательностью вершины*.

**Случай** $m=1$

$H_{a,1}^1$ — граф с единственной вершиной $v_1$ и петлей в ней. Пусть граф $H_{a,1}^{n-1}$ c $n-1$ вершинами $\{v_1,\ldots,v_{n-1}\}$ и $n-1$ ребрами построен. Построим граф $G_1^n$ добавлением вершины $v_n$ и  одного исходящего из него ребра в вершину $v_i$, выбранную из множества $\{v_1,\ldots,v_{n}\}$ с вероятностью:
$$P(i=s)=\begin{cases}
\frac{\deg_{H_{a,1}^{n-1}}(v_s)+a-1}{(a+1)n-1} & 1\le s\le n-1 \\
\frac{a}{(a+1)n-1} & s=n
\end{cases}$$
При $a=1$ мы имеем в точности модель Боллобаша-Риордана.

**Случай** $m>1$

Граф $H_{a,1}^{m,n}$ получается из  $H_{a,1}^m$  склейкой вершин $\{v_1, \ldots, v_m\}$ в новую вершину $v_1'$ , вершин $\{v_{m+1}, \ldots, v_{2m}\}$ — в $v_2'$ и т. д.

### распределение степеней вершин

#### теорема

Пусть $m\ge 1$, $a\ge 1$ — фиксированные целые числа. Пусть $H_{a,m}^n$ — случайный граф в модели Бакли-Остгуса. Тогда для любого $d\le n^{1/\big(100(a+1)\big)}$ с вероятностью, стремящейся к единице при $n\to \infty$:
$$\frac{|\{v\in H_{a,m}^n: \deg v=d\}|}{n}=(a+1)(am+a)!C_{d+am-1}^{am-1}\frac{d!}{(d+am+a+1)!}\sim\frac{\text{const }(a,m) }{d^{a+2}}$$
Модель позволяет варьировать параметр степенного закона.

С другой стороны $a$ — целое число, и снова нельзя получить $\gamma\in(2,3)$.

#### теорема Гречникова

Пусть $m\ge 1$ — фиксированное целое число, $a\ge 1$ — любое вещественное число. Пусть $H_{a,m}^n$ — случайный граф в модели Бакли-Остгуса. Положим
$$\beta_{a,m,d}=\frac{B(d-m+ma,a+2)}{B(ma, a+1)}$$
где $B$ — бета-функция. Тогда для любого $d\ge m$
$$\mathbb{E}|\{v\in H_{a,m}^n: \deg 
v=d\}|=n\beta_{a,m,d}+O_{a,m}\bigg(\frac{1}{d}\bigg)$$
а при условии $d=o(n^{1/(a+2)})$ с вероятностью, стремящейся к единице при $n\to\infty$:
$$\frac{|\{v\in H_{a,m}^n: \deg v=d\}|}{n}\sim n\beta_{a,m,n}$$
При этом $\beta_{a,m,d}=\Theta(d^{-2-a})$ и $a$ — любое. Можем задавать распределение по своему усмотрению.


# семинар

## задача

Какая наименьшая степень может быть у первой вершины случайного графа $G_m^n$ в модели Боллобаша-Риордана? С какой вероятностью степень будет именно такой?

---

- Граф $G_m^n$ получается из графа $G_1^{mn}$ склейкой вершин, в которой вершины $1,2,\ldots, m$ графа $G_1^{mn}$ объединяются в первую вершину графа $G_m^n$
- Степень первой вершины $G_m^n$ как минимум $2m$
- При этом если все остальные ребра графа $G_1^{mn}$ из вершин $m+1, \ldots, mn$ идут не в вершины $1,2,\ldots, m$, то степень первой вершины $G_m^n$ остается $2m$. Это и есть минимальная степень.

Найдем вероятность того, что все ребра из вершин $m+1, \ldots, mn$  графа $G_1^{mn}$ идут в вершины , отличные от $1,2,\ldots, m$.

- Рассмотрим процесс построения графа $G_1^{mn}$
- Пусть построен граф $G_{1}^{k-1}, k>m$ и добавляется вершина $k$. Вероятность того, что конец нового ребра, исходящего из нее, не содержится во множестве $\{1, \ldots, m\}$ равна
$$1- \sum_{j-1}^mP(k\to j)$$
Пусть в $G_{1}^{k-1}$ нет ребер из вершин $m+1, \ldots, k-1$, ведущих в вершины $1,2,\ldots, m$.
$$\begin{aligned}
1- \sum_{j-1}^mP(k\to j) &= 1 - \sum_{j=1}^m\frac{\deg j}{2k-1}=1-\frac{1}{2k-1}\bigg(\sum_{j=1}^m\deg j\bigg) =1-\frac{2m}{2k-1}
\end{aligned}$$

Тогда искомая вероятность равна:
$$\begin{aligned}
\bigg(1-\frac{2m}{2m+1}\bigg)\cdot\bigg(1-\frac{2m}{2m+3}\bigg)\cdots\bigg(1-\frac{2m}{2nm-1}\bigg) =\frac{1}{2m+1}\cdot  \frac{1}{2m+3}\cdots \frac{2nm-1-2m}{2mn-1}
\end{aligned}$$

Числитель — это произведение нечетных чисел:
$$1\cdot3\cdot \ldots\cdot(2nm-2m-1)=\frac{(2nm-2m)!}{2\cdot 4\cdot\ldots\cdot(2nm-2m)}=\frac{(2nm-2m)!}{2^{mn-n}(nm-n)!}$$
Теперь знаменатель:
$$(2m+1)\cdot(2m+3)\cdot\ldots\cdot(2nm-1)=\frac{(2nm)!}{(2m)!\cdot(2m+2)\cdot\ldots\cdot(2nm)}=\frac{(2nm)!m!}{(2m)!2^{nm-m}(nm)!}$$

Теперь собираем вместе:
$$=\frac{(2nm-2m)!(2m)!(nm)!}{(nm-m)!(2nm)!m!}=\frac{C^{m}_{nm}}{C_{2mn}^{2m}}$$

