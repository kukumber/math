# априорное и апостериорное распределения

Основное отличие байесовского подхода состоит в том, что есть предположение, что параметр $\theta$ — случайная величина.

Пусть  $X$  — наблюдение из неизвестного распредления $P\in\{P_\theta,\theta\in\Theta\}$. Пусть все распределения $P_\theta$ имеют обобщенную плотность $p_\theta(x)$ по мере $\mu$, то есть все семейство $P_\theta$ является доминируемым семейством. Пусть есть параметр $\theta\in \Theta$ — случайная величина на пространстве $(\theta, \mathcal{B}_\Theta,Q)$,  где $Q$ называется априорным распределением параметра $\theta$, то есть это те знания о параметре, которые были до эксперимента.

Правдоподобием в этой модели будет
$$f(X,\theta)=\prod_{i=1}^n p_\theta(X_i)q(\theta)$$
где $q$ — плотность распределения $Q$.

Определим апостериорное распределение, то есть распределение параметра $\theta$, уточненное с помощью данных, полученных в результате эксперимента.

Плотность 
$$q(\theta|X)=\frac{f(X,\theta)}{\int f(X,\theta)d\theta}$$
будет называться **апостериорной плотнотью** параметра $\theta$.

# подходы к сравнению оценок

Оценка, полученная следующим методом:
$$\hat\theta=\int_\Theta\theta q(\theta|X)d\theta$$
называется байесовской оценкой параметра $\theta$.

Определим байесовскую функцию риска
$$\tilde{R}(\hat\theta)=\int_\Theta R(\hat\theta,t)q(t)dt$$
Оценка $\hat\theta$ лучше оценки $\theta^*$ в баейсовском подходе, если выполнено условие
$$\tilde{R}(\hat\theta)<\tilde{R}(\theta^*)$$

# теорема о байесовской оценке

Байесовская оценка $\hat\theta$ является наилучшей оценкой параметра $\theta$ в байесовском подходе с квадратичной функцией потерь.

# пример поиска байесовской оценки

Пусть $X_1,\ldots,X_n$ — выборка из распределения парето с плотностью $p_\theta(X)=\frac{\theta}{x^2}I(x>\theta)$. Найти байесовскую оценку параметра $\theta$ при условии, что $\theta$ имеет равномерное распределение на отрезке $[0,1]$.

Функция правдоподобия для выборки
$$f(X,t)=\frac{t^n}{\prod_{i=1}^n X_i^2}\cdot I(X_{(1)}>t)$$
теперь умножить на плотность параметра $\theta$
$$f(X,t)=\frac{t^n}{\prod_{i=1}^n X_i^2}\cdot I(X_{(1)}>t)\cdot I(t\in[0,1])$$
тогда
$$\begin{aligned}
q(t|X)=\frac{f(X,t)}{\int_\mathbb{R}f(X,t)dt}&=\frac{t^n\cdot I(t\in[0,\min(X_{(1)}, 1)])}{\int_{0}^{\min(X_{(1)},1)}t^ndt}=\\
&=\frac{t^nI(t\in[0,\min(X_{(1)}, 1)])}{\frac{1}{n+1}\big(\min(X_{(1)},1)\big)^{n+1}}
\end{aligned}$$

тогда
$$\hat\theta=\int_{\mathbb{R}}tq(t|X)dt=\frac{\int_{0}^{\min(X_{(1)}, 1)}t^{n+1}dt}{\frac{1}{n+1}\big(\min(X_{(1)}, 1)\big)^{n+1}}=\min(X_{(1)}, 1)\cdot\frac{n+1}{n+2}$$

# сопряженные распределения

Пусть наблюдение $X$ сделано из распределения $P$, где $P\in\mathcal{A}$. Пусть $Q$ — априорное распределение $Q\in\mathcal {B}$. Тогда класс $\mathcal{B}$ называется сопряженным классу $\mathcal{A}$, если апостериорное распределение $Q_X\in\mathcal{B}$ для любого $Q\in\mathcal{B}$.

## задача

Пусть $X_1,\ldots,X_n$ — выборка из экспоненциального распределения с параметром $\theta$. Требуется предложить сопряженное распределение в качестве априорного и найти байесовскую оценку параметра $\theta$.

Правдоподобие выборки
$$p_t(X)=t^n e^{-t\cdot\sum X_i}\cdot I(t>0)$$
плотность гамма распределения
$$q(t)=\frac{t^{\alpha-1}\beta^{\alpha}}{\Gamma(\alpha)}e^{-\beta t}\cdot I(t>0)$$
перемножим
$$q(t,x)\propto t^{n+\alpha -1}e^{-(\sum X_i+\beta)t}\cdot I(t>0)=$$

получилось гамма распределение $\Gamma(n+\alpha,\sum X_i+\beta)$

тогда
$$\hat\theta=E_{q(t|X)}\theta=\frac{n+\alpha}{\sum X_i+\beta}$$
