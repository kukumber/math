## теорема (Four Colour Theorem)

$\chi(G)\le 4$ для любого планарного графа

## теорема

$\chi_l(G)\le 5$ для любого планарного графа $G$

## теорема

Существуют планарные графы с $\chi =3$ и $\chi_l=5$.

## теорема

$\chi_l(G)\le 3$ для любого двудольного планарного графа $G$.



# теорема Войгт

Существуют планарные графы с $\chi =3$ и $\chi_l=5$.

**доказательство**

Возьмем множество номеров от 1 до 12. Возьмем номера от 5 до 8 и зафиксируем один из этих номеров
$$\alpha\in \{5,6,7,8\}$$
возьмем номера от 9 до 12, зафиксируем один из них
$$\beta \in \{9,10,11,12\}$$
и рассмотрим граф, у которого каждой вершине присвоен список допустимых цветов
![[advanced_graphs_06_01.png]]

У верхней и нижней вершины цвета зафиксированы. Для каждой остальной вершины выдан список допустимых четырех цветов.

Поскольку верхняя вершина имеет соседями четыре другие, то можно на них исключить цвет $\alpha$. Тоже самое с четырьмя соседями $\beta$

![[advanced_graphs_06_02.png]]

Для вершин на центральном ребре остается всего два цвета: 1 и 2. Пусть 1 будет у левой вершины, а 2 — у правой. тогда у двух оставшихся вершин будет два допустимых цвета: 3 и 4. Тогда у серой вершины не остается вариантов для покраски
![[advanced_graphs_06_03.png]]

Для этого графа не существует правильной раскраски.

Можно заметить, что этот граф имеет обычное хроматическое число равное 3.

Объединим множество таких графов, поставив их в ряд, отождествив у них верхние и нижние вершины.

Для всевозможных блоков возьмем свои цвета $\alpha$ и $\beta$. Получится 16 блоков со списками. Верхней вершине сопоставляются цвета $\{5,6,7,8\}$, нижней — $\{9,10,11,12\}$.

Можно найти такой блок, для которого окажется невозможно раскрасить вершины.

# теорема Томассена

$\chi_l(G)\le 5$ для любого планарного графа $G$

**доказательство**

*Квазитриангуляция* — это планарный граф, границы всех граней которого являются простыми циклами, причем границы всех внутренних граней — треугольники.

Индукцией по $|G|$ докажем утверждение:

Пусть $G$  — произвольная квазитриангуляция, $C$ — цикл, ограничивающий внешнюю грань $G$. Пусть:
- две смежные вершины $x,y \in C$ уже окрашены в цвета $\alpha$ и $\beta$, соответственно
- вершинам на цикле $(C-\{x,y\})$ присвоены списки допустимых цветов размера не менее 3
- вершинам из $(G-C)$ приписаны списки допустимых цветов размера не менее 5

Тогда для вершин из $V(G)\backslash \{x,y\}$ можно выбрать цвета из их списков, так, чтобы получилась правильная раскраска $G$.

База индукции: когда $G$ — треугольник, то есть $|G|=3$.

Пусть $|G|>3$ 

Рассмотрим случай, когда у цикла $C$, ограничивающего внешнюю грань, есть хорда $uv\in E(G)\backslash E(C)$

![[advanced_graphs_06_04.png|w50]]

Так как в графе нет пересечений, то это ребро разбивает граф на две невзаимодействующие части $G_1$ и $G_2$. Вершины $x$ и $y$ попадают в одну из этих частей.

Применяем предположение индукции к $G_1$. Это граф, в котором число вершин меньше, чем в исходном $G$ и в нем все тоже самое. Пусть вершина $u$ получила цвет $\alpha$, вершина $v$ — цвет $\beta$. Для нижней части $G_2$ мы имеем ту же самую ситуацию, что и в предположении индукции.

Теперь рассмотрим случай, когда нет хорд, как в первом случае

![[advanced_graphs_06_05.png|w50]]
Тогда рассматриваем вершину $u$ — соседа $x$ на цикле, отличного от вершины $y$. Также рассматриваем $w$ — соседа вершины $u$, а также соседей вершины $u$ — $v_1,v_2,\ldots, v_k$. Ребра, идущие из вершины $u$ не попадают на цикл. У вершин $v$ по пять допустимых цветов.  В списке $L_u$ есть два цвета $\gamma$ и $\delta$, отличные от $\alpha$. Исключим эти два цвета из всех списков для вершин $v$. У каждой из них останется как минимум три цвета в списках.

Удалим из графа вершину $u$. Когда из квазитриангуляции из внешнего цикла удаляется вершина, то остается квазитриангуляция. Раскрасим оставшийся граф.

У вершины $u$ есть сосед $x$ с цветом $\alpha$ и соседи $v$, которые уже раскрашены. Но эти вершины были покрашены не в цвета $\gamma$ и $\delta$. У вершины $u$ есть еще один сосед $w$. Даже если она покрашенв в $\gamma$ или $\delta$, то можно покрасить оставшуюся вершину в один цвет.

# конструкция Зыкова—Мыцельского

Мы знаем простую оценку $\chi(G)\ge \omega(G)$.

В планарных графах нет $K_5$, то есть для них $\omega(G)\le 4$. А по теореме о четырех красках, для планарных графов $\chi(G)\le 4$.

Однако, нельзя в общем утверждать, что если $\omega(G)$ мало, то и $\chi(G)$ мало.

**теорема**

При любом $k\ge2$ существует связный граф $G_k$, для которого кликовое число $\omega(G_k)=2$ и $\chi(G_k)=k$.

**доказательство**

Конструкция Мыцельского. Построим последовательность $\{G_k\}^\infty_{k=2}$ по индукции.

Для начала возьмем $G_2:=K_2$.

Каждый граф будет строиться по предыдущему.

![[advanced_graphs_06_06.png]]

Пусть есть предыдущий граф $G_k=(V_k,E_k)$, и пусть $V_k=\{v_1,\ldots,v_n\}$.

Тогда $G_{k+1}=(V_{k+1},E_{k+1})$, где
- $V_{k+1}=V_k\cup \{v_1',\ldots,v_n'\}\cup\{v\}$ 
- $E_{k+1}=E_k\cup\{v_j'v\}^n_{i=1}\cup\{v_i'v_j|v_iv_j\in E_k\}$

Пусть $\phi_k$ — раскраска $G_k$ в цвета $\{1,\ldots,t\}$.

Тогда раскраску $\phi_{k+1}$ графа $G_{k+1}$ можно построить так: 
$$\phi_{k+1}(v_i):=\phi_k(v_i)$$
$$\phi_{k+1}(v):=t+1$$
Следовательно
$$\chi(G_{k+1})\le\chi(G_k)+1$$
![[advanced_graphs_06_07.png]]
По раскраске $\phi_{k+1}$ графа $G_{k+1}$ в $t$ цветов можно построить раскраску $\phi_k$ графа $G_k$:
$\phi_k(v_i):=\phi_{k+1}(v_i)$, если $\phi_{k+1}\ne\phi_{k+1}(v)$  и $\phi_k(v_i):=\phi_{k+1}(v_i')$ иначе.

![[advanced_graphs_06_08.png]]

Раскраска $\phi_k$ является правильной раскраской графа $G_k$ в $(t-1)$ цветов. Отсюда $\chi(G_k)\le\chi(G_{k+1})-1$, следовательно, $\chi(G_{k+1})=\chi(G_k)+1$.

Так как $\chi(G_2)=2$, получаем $\forall k \chi(G_k)=k$.

Покажем, что в графах $G_{k+1}$ нет треугольников при условии, что их нет в $G_k$:

- треугольник в $G_{k+1}$ не может содержать более одной вершины среди $\{v_i'\}^n_{i=1}$
- треугольник в $G_{k+1}$ не может содержать $v$, так как $v$ смежна только с вершинами $\{v_i'\}^n_{i=1}$
- треугольник в $G_{k+1}$ не может содержать только вершины из $\{v_i'\}^n_{i=1}$, так как в $G_k$ нет треугольников
- значит, если в $G_{k+1}$ есть треугольник, то он имеет вид $\{v_p, v_q, v_r'\}$. Но тогда вершины $\{v_p, v_q, v_r\}$ образуют треугольник в $G_k$ — противоречие.

Так как в $G_2$ нет треугольников, то их нет ни в одном $G_k$.

# теорема Эрдёша. формулировка, оценка вероятностей двух событий

Обхват графа $G$ — это наименьший размер цикла в графе, обозначается $g(G)$.

Если $g(G)>k$, то в $G$ окрестность любой вершины радиуса $\lfloor k/2\rfloor$ является деревом.

**теорема**

При любом $k$ существует граф $G$, для которого $g(G)>k$, $\chi(G)>k$.

**доказательство**

Пусть $k\ge 10$. Положим $n:=(4k)^{4k}$ и рассмотрим случайный граф $G$ на $n$ вершинах, проводя каждое ребро с вероятностью $p:=n^{1/(2k)-1}$.

Введем случайную величину
$$X:=\text{\# циклов длины }\le k$$
Используя линейность матожидания
$$\mathbb{E}[X]=\sum_{i=3}^k \binom ni \cdot\frac{(i-1)!}{2}\cdot p^i$$
оценим
$$\begin{aligned}
\mathbb{E}[X]&=\sum_{i=3}^k \binom ni \cdot\frac{(i-1)!}{2}\cdot p^i< \\
&< \sum_{i=3}^k\frac{n^i}{i!}\cdot\frac{(i-1)!}{2}\cdot p^i <\\
&< \sum_{i=3}^k(np)^i=\sum_{i=3}^k(n^{1/(2k)})^i<k\sqrt n
\end{aligned}$$
по неравенству Маркова
$$Pr\bigg[X\ge\frac{n}{2}\bigg]\le\frac{\mathbb{E}[X]}{n/2}<\frac{2k}{\sqrt n}<\frac{1}{2}$$
Вероятность того, что количество циклов маленькой длины в графе $\ge n/2$ строго меньше $1/2$.

Положим $t:=[n^{1-1/(4k)}]$ и введем случайную величину
$$Y := \text{\# независимых мн-в размера t в графе}$$
Пользуясь неравенством $1-p<e^{-p}$ и, помня, что $p=n^{1/(2k)-1}$, выводим
$$\begin{aligned}
\mathbb{E}[Y] &= \binom n t(1-p)^{\binom t 2} < \bigg(\frac{en}{t}\bigg)^t e^{-pt(t-1)/2}=\\
&= (t^{-1}ne^{1-p(t-1)/2})^t <\\
&< (t^{-1}ne^{2-pt/2})^t\le \\
&\le \bigg(n^{1/(4k)}e^{2-0.5n^{1/(4k)}}\bigg)^t=\\
&= (4ke^{2-2k})^t<\frac{1}{2}
\end{aligned}$$
Матожидание количества независимых множеств размера $t$  в графе $<\frac{1}{2}$. 

Пользуясь неравенством Маркова
$$Pr[Y\ge1]\le\mathbb{E}[Y]\le\frac{1}{2}$$
то есть
$$Pr\bigg[\alpha(G)\ge n^{1-1/(4k)}\bigg]<\frac{1}{2}$$

Вероятность того, что в графе $G$ окажется больше $\frac{n}{2}$ циклов длины $\le k$ или хотя бы одно независимое множество размера $n^{1-1/(4k)}$
$$<\frac{1}{2}+\frac{1}{2}=1$$Значит, с положительной вероятностью случайный граф $G$ содержит не более $\frac{n}{2}$ циклов длины $\le k$ и имеет $\alpha(G)<n^{1-1/(4k)}$.

Удалим из каждого цикла длины $\le k$ произвольную вершину. Отстанется граф $G'$, для которого

- $g(G')>k$
- $|G'|\ge\frac{1}{2}$
- $\alpha(G')\le\alpha(G)<n^{1-1/(4k)}$

Имеем
$$\chi(G')\ge\frac{|G'|}{\alpha(G')}>\frac{n/2}{n^{1-1/(4k)}}=2k$$
