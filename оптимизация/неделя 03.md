# основные сведения из линейной алгебры

**Вектор** $x\in\mathbb{R}^n$ — это просто набор из $n$ чисел.

**Матрица** $A\in\mathbb{R}^{n\times n}$ — это таблица из $n^2$ чисел. У нее есть столбцы и строки. С помощью матриц моделируются как некоторые геометрические преобразования, так и величины из теории вероятностей.

**Система линейных уравнений** $Ax=b$. Системы могут быть разрешимыми и неразрешимыми, недоопределенными, переопределенными.

**Собственные значения и векторы** 
Ненулевой вектор собственный, если найдется такое число $\lambda$, что выполнено следующее равенство
$$Av = \lambda v$$

**Разложение по собственным векторам**
Матрица $A$ называется **диагонализуемой**, если найдутся такие собственные векторы $v$ и числа $\lambda$,  что ее можно представить как произведение матриц
$$A=U\Sigma U^{-1}$$
где $U$ — матрица со столбцами из собственных векторов, $\Sigma$ — диагональная матрица с собственными значениями на диагонали, $U^{-1}$ — обратная матрица.

Отдельный важный случай, когда матрица **унитарно диагонализуема**. В этом случае вместо обратной матрицы появляется сопряжение, транспорнирование. Это удобно, потому что обращение матрицы — это не очень устойчивая операция и ее вычисление довольно трудоемко, в отличие от транспонирования.

## операции над векторами

### сложение
$$z_i=x_i+y_i$$
Векторы можно складывать, при условии, что у них одинаковая размерность. Итоговый вектор $z_i$ — это сумма соответствующих компонент векторов $x_i$ и $y_i$.

Сложность сложения линейна $O(n)$

### умножение на число
$$z_i=cx_i$$
Умножение производится покомпонентно.

Сложность умножения линейна $O(n)$

### скалярное произведение
$$\langle x, y\rangle = x^Ty=\sum_{i=1}^nx_iy_i$$
Сумма произведений соответствующих координат. Эти операции справедливы, когда векторы одинаковой длины, то есть подразумевается, что они все из некоторого подмножества $\mathbb{R}^n$.

Сложность скалярного произведения линейна $O(n)$

## операции над матрицами

### сложение
$$c_{ij}=a_{ij}+b_{ij}$$
Требуется, чтобы обе размерности матриц совпадали.

### умножение на число
$$c_{ij}=ka_{ij}$$

Сложность этих операций $O(n^2)$

### умножение двух матриц n x n
$$c_{ij}=\sum_{k=1}^na_{ik}b_{ik}$$
Скалярное произведение строки $i$ матрицы $a$ на столбец $j$ матрицы $b$.
Число столбцов матрицы $a$ должно совпадать с числом строк матрицы $b$.

Сложность $O(n^3)$

### след матрицы
$$Tr(A)=\sum_{i=1}^na_{ii}$$
Функция определена только для квадратной матрицы. Это просто сумма диагональных элементов.

Сложность $O(n)$.

## операции над векторами и матрицами

### умножение матрицы на вектор
$$y=Ax$$
Умножение каждой строки матрицы на этот вектор, как скалярное произведение двух векторов. 

Сложность $O(n^2)$

### решение системы линейных уравнений
$$Ax=b$$

Сложность $O(n^3)$

# основные определения

Пусть есть функция с областью определения $D$ и областью значения $E$
$$f:D\to E$$
производная этой функции принадлежит множеству $G$
$$\frac{\partial f}{\partial x}\in G$$

| $D$ | $E$ | $G$ | название |
|---|---|---|---|
| $\mathbb{R}$ | $\mathbb{R}$ | $\mathbb{R}$ | производная $f'(x)$ |
| $\mathbb{R}^n$ | $\mathbb{R}$ | $\mathbb{R}^n$ | градиент $\frac{\partial f}{\partial x_i}$ |
| $\mathbb{R}^{m\times n}$ | $\mathbb{R}$ | $\mathbb{R}^{m\times n}$ | градиент $\frac{\partial f}{\partial x_{ij}}$ |
| $\mathbb{R}^n$ | $\mathbb{R}^m$ | $\mathbb{R}^{n\times m}$ | матрица Якоби $\frac{\partial f_i}{\partial x_j}$ |


Квадратная матрица $n\times n$ вторых производных $H=[h_{ij}]$ в случае $f:\mathbb{R}^n \to \mathbb{R}$ называется **гессиан** и равна:
$$h_{ij}=\frac{\partial^2f}{\partial x_i \partial x_j}$$

## основная техника

На случай гессианы техника будет обобщаться очень просто, потому что гессиана — это по сути производная от градиента.

1. **матричное представление**

Есть функция, которая задана в матричном представлении и при ее вычислении участвуют векторы и матрицы
$$f(x)=x^TAx, A\in S^n$$
где $S^n$ — обозначение симметричной матрицы, размерности $n\times n$

2. **скалярное произведение**

Затем нужно понять, как ее записать поэлементно. Понятно, что эта функция отображает $x \to \mathbb{R}$, то есть вектор в число. Ее нужно записать, используя элементы векторов и матриц
$$f(x)=\sum_{ij}a_{ij}x_ix_j$$
3. **определение $k$-го элемента градиента**

Градиент — это в данном случае вектор, каждый элемент которого — это результат взятия частной производной от результата выполнения функции по соответствующей компоненте $x$ (аргумента)
$$\nabla f_k=\frac{\partial f}{\partial x_k}$$
4. **вычисление**

Применяем определение к функции. $i$ и $j$ — это разные элементы. Важно выделить те, в которых фигурирует $x_k$, чтобы найти только те слагаемые, которые от него зависят.

Производная произведения — это сумма произведений, в первом производная берется по первому аргументу, второй остается неизменным, во втором слагаемом — производная от второго аргумента, первый остается неизменным
$$\nabla f_k=\sum_ja_{kj}x_j+\sum_ia_{ik}x_i=2\sum_ja_{kj}x_j$$
5. **матричное представление градиента**

Преобразование к матричному представлению
$$\nabla f(x)=2Ax$$

# примеры применения

## 1

Линейная функция $f(x)=c^Tx$, где вектор $c$ — фиксированный.

1. матричное представление
$$f=\sum_{i=1}^nc_ix_i$$
2. определение $k$-го компонента
$$\nabla f_k=\frac{\partial}{\partial x_k}\bigg(\sum_{i=1}^nc_ix_i\bigg)=c_k$$
3.  матричное представление
$$\nabla f(x)=c$$
## 2

Квадратичная форма 
$$f(x)=\frac{1}{2}x^TAx+b^Tx$$
1. матричное представление
$$f=\frac{1}{2}\sum_{ij}a_{ij}x_{i}x_j+\sum_{i=1}^nb_ix_i$$
2. определение $k$-го компонента
$$\begin{aligned}
\nabla f_k &= \frac{\partial}{\partial x_k}\bigg(\sum_{ij}a_{ij}x_{i}x_j+\sum_{i=1}^nb_ix_i\bigg)= \\
&=\frac{1}{2}\bigg(\sum_{j}a_{kj}x_{j}+\sum_{i}a_{ik}x_i\bigg)+b_k
\end{aligned}$$

3. матричное представление
$$\nabla f(x)=\frac{A+A^T}{2}x+b$$

Если $A\in\mathbb{S}^n$
$$\nabla f(x)=Ax+b$$

## 3
$$f(x)=||Ax-b||_2^2$$
1. приведение к стандартному виду
$$\begin{aligned}
||Ax-b||_2^2 &=(Ax-b)^T(Ax-b)= \\
&= x^TA^TAx-x^TA^Tb-b^TAx+b^Tb
\end{aligned}$$
2. в итоге
$$x^TA^TAx-2b^TAx$$
3. по предыдущему примеру
$$\nabla f(x)=2(A^TAx-A^Tb)$$
так как матрица $A^TA$ симметричная

# примеры применения для сложных функций

Функция $f(x)$ представляется в виде суперпозиции от функций $g$ и $u$
$$f(x)=g\big(u(x)\big)$$
при этом функция $u$ отображает вектор $x$ в скаляр, а $g$ — фукнция скалярного аргумента из $\mathbb{R}$ в $\mathbb{R}$ в какой-то другой скаляр.

Тогда градиент
$$\nabla f(x)=\frac{\partial g}{\partial u}\frac{\partial u}{\partial x}$$

## 1
$$f(x)=||x||_2$$
1. по определению
$$||x||_2=\sqrt{x^Tx}$$
То есть, функция $g$ — это квадратный корень, а $u$ — квадрат нормы.

2. посчитаем градиент как градиент от функции $g$, умноженный на градиент от функции $u$
$$\nabla f(x)=\frac{1}{2\sqrt{x^Tx}}\nabla(x^Tx)=\frac{1}{2||x||_2}\nabla (x^Tx)$$
градиент от $g$ — это производная от квадратного корня

3. градиент от функции $u$
$$\nabla (x^Tx)=\frac{\partial}{\partial x_k}\bigg(\sum_{i=1}^nx^2_i\bigg)=2x_k$$
4. подставлям результат 3 в формулу 2
$$\nabla f(x)=\frac{x}{||x||^2}$$
Это верно в случаях, когда $x$ не равен нулю.

## 2
$$f(x)=-e^{-x^Tx}$$
1. 
$$(e^x)'=e^x$$
2. 
$$\nabla(x^Tx)=2x$$
3. в итоге
$$\nabla f(x)=2e^{-x^Tx}x$$
