# общий подход к построению двойственных задач

1. записываем Лагранжиан
2. ищем минимум по прямым переменным, находим зависимость $x(\mu,\lambda)$
3. подставляем в лагранжиан и получаем двойственную функцию
4. ставим двойственную задачу, максимизируем $g(\lambda,\mu)$

**замечание**
1. для некоторых задач конической оптимизации такой подход может быть довольно громоздким
2. для таких задач есть более простая, эквивалентная техника

## примеры
### 1
Получить двойственную задачу
$$\begin{aligned}
&\min||x||^2_2\\
\text{s.t. }&Ax=b
\end{aligned}$$

Лагранжиан
$$L(x,\lambda)=||x||^2_2+\lambda^T(Ax-b)$$
является выпуклой по $x$.

$$L_x'(x,\lambda)=2x+A^T\lambda$$
$$L_x'(x,\lambda)=0$$
$$x^\ast=-\frac{A^T\lambda}{2}$$
двойственная функция
$$g(\lambda)=L(x^\ast,\lambda)=-\frac{1}{4}||A^T\lambda||^2_2-\lambda^Tb$$
функция вогнута.

Двойственная задача
$$\max_\lambda g(\lambda)$$
### 2

Получить двойственную задачу
$$\begin{aligned}
&\min c^Tx\\
\text{s.t. }&Ax=b\\
&x \ge0
\end{aligned}$$

Геометрически это означает, что мы ищем минимум плоскости на каком-то многоугольнике.

Лагранжиан
$$L(x,\lambda,\mu)=c^Tx+\lambda^T(Ax-b)-\mu^Tx$$
приведя подобные слагаемые
$$L(x,\lambda,\mu)=(c-\mu+A^T\lambda)^Tx-\lambda^Tb$$
это линейная функция по $x$.

Двойственная функция
$$g(\lambda,\mu)=\begin{cases}
-\lambda^Tb, &c-\mu+A^T\lambda=0\\
-\infty, &\text{otherwise}
\end{cases}$$
Двойственная задача
$$\begin{aligned}
&\max_{\mu,\lambda}-\lambda^Tb\\
\text{s.t. }&\mu\ge0\\
&c-\mu+A^T\lambda=0
\end{aligned}$$

## слабая и сильная двойственность

Оптимальные значения целевой функции в прямой и двойственной задаче связаны соотношением 
$$d^\ast\le p^\ast$$
если $d^\ast < p^\ast$, то свойство называют слабой двойственностью
если $d^\ast=p^\ast$, то — сильной двойственностью

## критерий субоптимальности

По построению $p^\ast\ge g(\lambda, \mu)$, поэтому
$$f_0(x)-p^\ast\le f_0(x)-g(\lambda,\mu)=\varepsilon$$

Разность $f_0(x)-g(\lambda,\mu)$ называется двойственным зазором и является оценкой сверху для разности текущего и оптимального значения функции.

способы использования:
- критерий остановки в итерационном процессе
- теоритическая оценка сходимости алгоритма
- проверка оптимальности данной точки