# Связь первых моментов и распределения случайной величины

Допустим, есть случайная величина $\xi=\xi(G)$, зависящая от графа, — количество треугольников в случайном графе $G$.

Математическое ожидание будет
$$M\xi=\sum_{k=0}^{C_n^3}kP(\xi=k)$$
по линейности
$$M\xi=M(\xi_1+\ldots+\xi_{C_n^3})=C_n^3p^3$$
можно утверждать на основе неравенства Маркова
$$np(n)\xrightarrow[n\to\infty]{}0 \Rightarrow M\xi\xrightarrow[n\to\infty]{}0\Rightarrow P(\xi=0)\xrightarrow[n\to\infty]{}1$$
а с неравенством Чебышева
$$np(n)\xrightarrow[n\to\infty]{}+\infty \Rightarrow P(\xi\ge 1)\xrightarrow[n\to\infty]{}1$$
Знание первых двух моментов распределения случайной величины позволяет многое сказать обо всем распределении случайной величины.

# факториальные моменты

$$M_f^r\xi=M\big(\xi\cdot(\xi-1)\cdot\ldots\cdot(\xi-r+1)\big)=\sum_{k=0}^nk(k-1)\ldots(k-r+1)P(\xi=k)$$
Считаем, что $\xi$ дискретна
$$\xi:\Omega\to\{0,1,\ldots,n\}$$
или она может принимать счетное число значений
$$\xi:\Omega\to\{0, 1,\ldots\}$$

# формула обращения

*Теорема*
$\xi$ принимает конечное множество значений
$$\xi:\Omega\to\{0,1,\ldots,n\}$$
Тогда
$$\forall k\in\{0, 1, \ldots, n\} \ P(\xi=k)=\sum_{r=k}^n\frac{(-1)^{r-k}\cdot M_f^r\xi}{k!(r - k)!}$$

$k$-й факториальный момент случайной величины $\xi$
$$M_f^k\xi=\sum_{i=0}^ni(i-1)\ldots(i-k+1)P(\xi=i)=$$вплоть до $k-1$ все слагаемые будут равны нулю, и только начиная с $k$ будет нормальное значение
$$=k!P(\xi=k)+\ldots$$

# пуассоновская аппроксимация

$\xi \sim Poisson(\lambda), \lambda>0$.  $\lambda$ — это математическое ожидание $\xi$.

$\forall r \ M_f^r\xi=\lambda^r$ 

Пусть $\xi_n$ — это последовательность случайных величин, каждая из них принимает неотрицательные целые значения и $\forall r \ M_f^r\xi_n\sim\lambda^r, \lambda >0$. Тогда $\forall k \ P(\xi_n=k)\sim \frac{\lambda^ke^{-\lambda}}{k!}, k=0,1,2,\ldots$

# деревья в случайном графе

Пусть $G(n,p)$ — случайный граф, $n$ — множество вершин, $p$  — некоторое число $p\in[0,1]$, при этом $p$ зависит от $n$.

$\xi_n=\xi_n(G)$ — это число связных компонент $G$, каждая из которых является деревом на $k$ вершинах. Пусть $k=3$.

*Теорема*
Пусть $p(n)n^\frac{3}{2}\xrightarrow[n\to\infty]{}0$ или иными словами $p=o\bigg(\frac{1}{n^{\frac{3}{2}}}\bigg)$. Тогда почти наверное в случайном графе компонент не будет $p(\xi_n=0)\xrightarrow[n\to\infty]{}1$. 
$$p(\xi_n=0)=1-p(\xi_n\ge 1)\ge 1-M\xi_n=1-C_n^33p^2(1-p)^{1+3(n-3)}$$
$$n^3p^2=(n^{3/2}p)^2\to0$$

*Теорема*
Пусть $p(n)n^\frac{3}{2}\xrightarrow[n\to\infty]{}c$ то есть $p$ ведет себя как $\bigg(p\sim\frac{c}{n^{3/2}}\bigg)$. Тогда $\xi_n$ имеет асимптотически пуассоновское распределение с параметром $\lambda=\frac{c^23}{6}=\frac{c}{2}$.


*Доказательство*

$$M\xi_n=C_n^33p^2(1-p)^{1+3(n-3)}\sim\frac{n^3}{2}\frac{c^2}{n^3}\bigg(1-\frac{c}{n^{3/2}}\bigg)^{1+3(n-3)}=\frac{c^2}{2}e^{\big(1+3(n-3)\big)\ln\bigg(1-\frac{c}{n^{3/2}}\bigg)}=$$
$$=\frac{c^2}{2}e^{-(1+o(1))\frac{c}{n^{3/2}}(3n-8)}\sim\frac{c^2}{2}e^{-\frac{3c(1+o(1))}{\sqrt{n}}}\sim\frac{c^2}{2}=\lambda$$


$$M_f^2\xi_n=M\big(\xi_n(\xi_n-1)\big)=M\xi_n^2-M\xi_n=$$
$\xi_n$ — это сумма некоторого числа индикаторов $\eta_1, \ldots,\eta_{3C_n^3}$ 
Что значит, что перечислено столько индикаторов? Это значит, что перечислены все трехэлементные подмножества множества вершин и для каждого из этих подмножеств перечисляем все деревья, которые можно на этих элементах построить. 
$$\eta_i=\begin{cases}
1 \\
0
\end{cases}$$
Тогда
$$M\xi_n^2 =M(\eta_1+\ldots+\eta_{3C_n^3})^2=M(\eta_1^2+ \ldots +\eta_{3C_n^3}^2+\sum_{i\ne j}\eta_i\eta_j)=$$
так как мы возводим в квадрат нули и единицы, то квадраты можно убрать
$$=M(\eta_1+ \ldots +\eta_{3C_n^3}+\sum_{i\ne j}\eta_i\eta_j)=$$
и тогда левая часть до знака суммы — это по линейности просто $M\xi_n$
$$=M\xi_n+\sum_{i\ne j}M(\eta_i\eta_j)$$
и для второго момента мы вычитаем математическое ожидание
$$M_2^r\xi_n=M\big(\xi_n(\xi_n-1)\big)=M\xi_n^2-M\xi_n=\sum_{i\ne j}M(\eta_i\eta_j)$$
Если вычисляем $r$ факториальный момент, то это можно выразить точно так же
$$M_f^r\xi_n=\sum_{(i_1,\ldots,i_r), i_\nu\ne i_\mu}M(\eta_{i_1}\cdot\ldots\cdot\eta_{i_r})$$

Суммировать нужно по упорядоченным парам индексов, для которых деревья не имеют общих вершин
$$\sum_{i\ne j}M(\eta_i\eta_j)$$
тогда математическое ожидание произведения равно вероятности того, что оба дерева присутствуют в графе, не имеют лишних ребер и образуют компоненту связности
$$M(\eta_i\eta_j)=p^4(1-p)^{2+6(n-3)-a}$$
$a$ — это дубликаты ребер

В итоге получаем
$$M_2^r\xi_n=\sum_{i\ne j}M(\eta_i\eta_j)\sim C_n^33C_{n-3}^33p^4(1-p)^{6n}\sim9(C_n^3)^2(p^2)^2\big((1-p)^{3n}\big)^2\sim \lambda^2$$


Остальные факториальные моменты
$$(p^2)^r(1-p)^{r+3(n-3)+\ldots+3(n-3)-a_r}\sim C_n^3C_{n-3}^3\cdot C_{n-(r-1)3} 3^r(p^2)^r\big((1-p)^{3n}\big)^r\sim \big(C_n^33p^2(1-p)^{3n}\big)^r\sim \lambda^r$$
