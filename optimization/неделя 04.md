# выпуклые функции и их свойства

Выпуклая функция важное понятие — потому что эффективные алгоритмы существуют для решения именно выпуклых задач, которые, в свою очередь, определяются выпуклыми множествами и выпуклыми функциями.

Функция $f(x)$, определенная на выпуклом множестве $G$ называется выпуклой на $G$, если $\forall \alpha \in [0,1] \ \forall x,y\in G$ выполняется неравенство
$$f(\alpha x+(1-\alpha)y)\le\alpha f(x)+(1-\alpha)f(y)$$

При условии $\forall \alpha \in [0,1]$ в левой стороне неравенства находится выпуклая комбинация точек $x$ и $y$, справа — выпуклая кобминация $f(x)$ и $f(y)$.

Какую бы точку на отрезке $[x, y]$ мы ни взяли, значение функции в этой точке должно лежать ниже, чем выпуклая комбинация значений функций на концах данного отрезка.
![[optimization_04_01.png]]

Либо другой вариант геометрической интерпретации: график выпуклой функции должен лежать выше касательной гиперплоскости
![[optimization_04_02.png]]

# строго выпуклая функция

Функция $f(x)$, определенная на выпуклом множестве $G$ называется строго выпуклой на $G$, если $\forall\alpha\in(0,1) \ \forall x,y\in G, \ x\ne y$ верно неравенство
$$f(\alpha x+(1-\alpha)y)<\alpha f(x)+(1-\alpha)f(y)$$

График **строго выпуклой функции** лежит **строго** выше касательной гиперплоскости.

Например, функция $x_+^2$, где $x_+$ — это положительная срезка
$$x_+^2=\big(\max(0,x)\big)^2$$
будет просто выпуклой:

![[optimization_04_03.png]]

А функция $f(x)=e^x$ будет строго выпуклой
![[optimization_04_04.png]]

Разница в том, что на первом графике есть участок, где выпуклая комбинация значений функции будет совпадать со значением функции в точке, которая является выпуклой комбинацией точек (при $x<0$), также касательная  гиперплоскость не будет лежать строго ниже функции.

Во втором случае график функции лежит строго выше касательной гиперплоскости и для любых двух точек выполняется строгое неравенство.

# вогнутая функция

Функция $f(x)$, определенная на выпуклом множестве $G$ называется **вогнутой** на $G$, если $\forall \alpha \in [0,1] \ \forall x,y \in G$ выполняется неравенство
$$f(\alpha x+(1-\alpha)y)\ge\alpha f(x)+(1-\alpha)f(y)$$
![[optimization_04_05.png]]

### второе определение

Функция $f(x)$ заданная на выпуклом множестве $G$ называется **вогнутой (строго вогнутой)**, если $g(x)=-f(x)$ является выпуклой (строго выпуклой) функцией.

# сильно выпуклая функция

Функция $f(x)$, определенная на выпуклом множестве $G$, называется **сильно выпуклой** на $G$ с константой $\mu>0$, если $\forall\alpha\in [0,1], \ \forall x,y \in G$ выполняется неравенство
$$f(\alpha x+(1-\alpha)y)\le \alpha f(x)+(1-\alpha)f(y)-\frac{\mu}{2}\alpha(1-\alpha)||x-y||_2^2$$
По сравнению с выпуклой функцией правая часть усиливается тем, что из нее вычитается положительный член.

График сильно выпуклой функции лежит выше некоторого параболоида.

# примеры

## $f(x)=x^2$

выпуклая функция
![[optimization_04_06.png]]

## $f(x)=e^x$

выпуклая функция
![[optimization_04_07.png]]

## $f(x)=\log(x)$

вогнутая функция
![[optimization_04_08.png]]

## $f(x)=ax^T+b$

![[optimization_04_09.png]]
Линейная функция и выпуклая и вогутая одновременно. Рассмотрим значение этой функции в точке, которая является выпуклой комбинацией двух точек
$$\begin{aligned}
f\big(\alpha x+ (1-\alpha)y\big)&=a^T(\alpha x+(1-\alpha)y)+\alpha b-\alpha b+b=\\
&=\alpha(a^Tx+b)+(1-\alpha)(a^Ty+b)=\\
&=a f(x)+(1-\alpha)f(y)
\end{aligned}$$
В случае выпуклой функции, значение функции в точке, которая является выпуклой комбинацией, должна иметь значение $\le a f(x)+(1-\alpha)f(y)$, в случае вогнутой $\ge a f(x)+(1-\alpha)f(y)$, а для линейной функции мы получаем просто равно. То есть она одновременно и выпуклая и вогнутая.

## $f(x)=||x||$

Для того, чтобы показать, что произвольная норма — выпуклая функция, возьмем две точки $x,y \in \mathbb{R}^n$ и коэффициент $\alpha\in[0,1]$. Рассмотрим значение функции в точке, которая является выпуклой комбинацией этих двух точек
$$\begin{aligned}
f(\alpha x+(1-\alpha)y)&=||\alpha x+(1-\alpha)y||\le \alpha||x||+(1-\alpha)||y||=\\
&=\alpha f(x)+(1-\alpha)f(y)
\end{aligned}$$

Здесь было использовано неравенство треугольника, где норма суммы меньше или равна сумме норм. Также, в силу неотрицательности коэффициента $\alpha$ его можно вынести из-под знака нормы.

# эпиграф

Эпиграф (надграфик) функции — это множество, состоящее из пар точек $x$ и $t$, для которых выполняется $t\ge f(x)$
$$epi f=\{(t,x):t\ge f(x)\}$$
$x\in\mathbb{R}^n, t\in\mathbb{R}, epif \subseteq \mathbb{R}^{n+1}$
![[optimization_04_10.png]]

Функция является выпуклой тогда и только тогда, когда ее надграфик — выпуклое множество.

# свойства выпуклых функций

1. выпуклые функции непрерывны во всех [[внутренние точки|внутренних точках]] области определения
2. сильно выпуклая функция — строго выпукла
3. функция является выпуклой тогда и только тогда, когда ее надграфик — выпуклое множество
4. для выпуклой функции $f(x)$ выполнено неравенство Йенсена
$$f\bigg(\sum_{i=1}^n\lambda_ix_i\bigg)\le\sum_{i=1}^n\lambda_i\big(f(x_i)\big)$$
где $\lambda_i\ge 0, \sum_{i=1}\lambda_i=1$

# операции, сохраняющие выпуклость

## положительная взвешенная функция

Пусть есть $m$ выпуклых функций $f_1,\ldots, f_m$ на одном и том же выпуклом множестве $G$, и $m$ неотрицательных чисел $\alpha_1, \ldots, \alpha_m$. Тогда функция
$$f(x)=\sum_{i=1}^m\lambda_if_i(x)$$
выпукла на $G$.

Покажем, что это так. Есть положительная функция, неоторицательный коэффициент и все функции выпуклы
$$f(x)=\sum_{i=1}^m\lambda_if_i(x),\lambda_i\ge0,f_i-вып.$$
По определению берем две точки из этого множества$x,y\in G$ и коэффициент $\alpha\in [0,1]$. Подставляем в функцию выпуклую комбинацию
$$f(\alpha x+(1-\alpha)y)=f(x)=\sum_{i=1}^m\lambda_if_i(\alpha x+(1-\alpha)y)\le$$
так как все $f_i$ — выпуклые функции, эту сумму можно сверху оценить как
$$\begin{aligned}
&\le \sum_{i=1}^m\lambda_i\big[\alpha f_i(x)+(1-\alpha)f_i(y)\big]=\\
&=\alpha\sum_{i=1}^m\lambda_if_i(x)+(1-\alpha)\sum_{i=1}^m\lambda_if_i(y)= \\
&=\alpha f(x)+(1-\alpha)f(y)
\end{aligned}$$
Что доказывает, что сумма выпуклых функций — выпукла.

## максимум выпуклых функций

Пусть есть $m$ выпуклых функций $f_1,\ldots, f_m$ на одном и том же выпуклом множестве $G$. Тогда функция
$$f(x)=\max_{i=1,m}f_i(x)$$
выпукла на $G$.

![[optimization_04_11.png]]

Допустим, есть две выпуклые функции $f_1$ и $f_2$.
$$f(x)=\max\{f_1(x),f_2(x)\}$$
$f_1$ — выпуклая функция, значит ее эпиграф — выпуклое множество. $f_2$ — выпуклая функция, значит ее эпиграф — выпуклое множество. Эпиграф функции $f(x)$ — это пересечение эпиграфов функций $f_1$ и $f_2$. Пересечение выпуклых множеств — это выпуклое множество. Значит эпиграф $f(x)$ — выпуклое множество. Значит сама функция — это выпуклое множество.

По определению. Берем выпуклую комбинацию 
$$f(\alpha x+(1-\alpha)y)$$
и подставляем
$$\begin{aligned}
&\max\big\{f_1\big(\alpha x+(1-\alpha)y\big),f_2\big(\alpha x+(1-\alpha)y\big)\big\}\}\le \\
&\le \max\big\{\alpha f_1(x)+(1-\alpha)f_1(y),\alpha f_2(x)+(1-\alpha)f_2(y)\big\} \le \\
&\le \alpha \max\big\{f_1(x), f_2(x)\big\}+(1-\alpha)\max\big\{f_1(y),f_2(y)\big\} = \\
&= \alpha f(x) + (1-\alpha)f(y)
\end{aligned}$$

## поточечный супремум

Если функция от двух аргументов $f(x,y)$ выпукла по $x\in \mathbb{R}^n$ для любого $y\in Y\subseteq\mathbb{R}^n$, то следующая функция
$$f(x)=\sup_{y\in Y}g(x,y)$$
также выпукла по $x$.

Примером может быть функция расстояния до наиболее удаленной точки множества $G$ 
$$f(x)=\sup_{y\in G}||x-y||$$
выпукла, даже когда $G$ не выпукло.

	## суперпозиция выпуклых функций

### вариант 1

Пусть функция $h(x)$ — **выпуклая**, $P(y)$ — **выпуклая и неубывающая** функция. Тогда
$$f(x)=P\big(h(x)\big)$$
выпуклая функция.

Возьмем две точки $x,y \in \mathbb{R}^n$ и коэффициент $\alpha\in[0,1]$. По определению
$$\begin{aligned}
&f(\alpha x+ (1-\alpha)y)=\\
&=P\big(h(\alpha x + (1-\alpha)y)\big)\le \\
&\le P\big(\alpha h(x)+(1-\alpha)h(y)\big) \le \\
&\le \alpha P\big(h(x)\big)+(1-\alpha)P\big(h(y)\big) \le \\
&\le \alpha f(x)+(1-\alpha)f(y)
\end{aligned}$$

**пример**
Пусть $h(x) = e^x$. Тогда $e^{h(x)}$ — выпуклая функция.

### вариант 2

Пусть функция $h(x)$ — **вогнутая** функция, $P(y)$ —  **выпуклая и невозрастающая** функция. Тогда
$$f(x)=P\big(h(x)\big)$$
выпуклая функция.

**пример**
Пусть $h(x)=-\log x$, тогда $f(x) = -\log\big(h(x)\big)$ при $h(x)>0$ — выпуклая функция.

## примеры
### пример 1

Является ли выпуклой функция 
$$f(x)=\exp\bigg(\sum_{i=1}^n|a^T_i-b_i|\bigg)$$
Функция $g_i(x)=|a_i^T-b_i|$ — выпукла, так как $|\cdot|$ — выпуклая, $a_i^T-b_i$ — линейная функция (аффинная подстановка аргумента).

Функция $h(x)=\sum_{i=1}^ng_i(x)$ — выпукла как сумма выпуклых функций.

Функция $f(x)=P\big(h(x)\big)$ — выпукла как суперпозиция выпуклой, неубывающей и выпуклой функций.

# дифференциальные критерии выпуклости

## критерий первого порядка

Пусть функция $f(x)$ дифференцируема на выпуклом множестве $X\subseteq\mathbb{R}^n$. Тогда $f(x)$ выпукла на $X$ тогда и только тогда, когда 
$$f(x)-f(y)\ge\nabla f(y)^T(x-y), \forall x,y\in X$$


Пусть функция $f(x)$ дифференцируема на выпуклом множестве $X\subseteq\mathbb{R}^n$. Тогда $f(x)$ выпукла на $X$ тогда и только тогда, когда
$$\big(\nabla f(x)-\nabla f(y)\big)^T(x-y)\ge0, \forall x,y\in X$$

## критерий второго порядка

Пусть $X\subseteq\mathbb{R}^n$— выпуклое множество, причем множество внутренних точек $int X\ne \varnothing$. $f(x)$ дважды непрерывно дифференцируемая функция на $X$. Тогда $f(x)$ выпукла на $X$ тогда и только тогда, когда
$$\nabla^2f(x)\succeq 0, \forall x\in X$$

# дифференциальные критерии сильной выпуклости

## критерий первого порядка

$$f(x)-f(y)\ge\nabla f(y)^T(x-y) + \frac{\mu}{2}||x-y||^2_2$$
$$\big(\nabla f(x)-\nabla f(y)\big)^T(x-y)\ge\frac{\mu}{2}||x-y||^2_2$$

### критерий второго порядка

$$\nabla^2f(x)\succeq \mu I, \forall x\in X$$

## пример

$f(x)=\frac{1}{2}||Ax-b||^2_2$

Вторая норма по сути — $||x||_2=\sqrt{x^Tx}$, тогда $||x||_2^2=x^Tx$ 

Функцию можно расписать как
$$\frac{1}{2}||Ax-b||^2_2=\frac{1}{2}(Ax-b)^T(Ax-b)$$

Берем градиент
$$\nabla f(x)=A^T(Ax-b)$$
Гессиан
$$\nabla^2 f(x)=A^TA$$
Матрица вторых производных положительно полуопределенная, то есть
$$h^T\nabla^2f(x)h\ge0, \forall h\in \mathbb{R}^n$$
тогда
$$h^T\nabla^2f(x)h=h^TA^TAh= ||Ah||^2_2\ge0, \forall h\in \mathbb{R}^n$$
