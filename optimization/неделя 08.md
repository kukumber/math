# двойственная функция

Задача
$$\min_{x\in D}f(x)=p^\ast$$
$$\begin{aligned}
\text{s.t. }& g_i(x)=0, i=1,\ldots,m \\
& h_j(x)\le 0, j=1,\ldots,p
\end{aligned}$$
Лагранжиан
$$L(x,\lambda,\mu)=f(x)+\sum_{i=1}^m\lambda_ig_i(x)+\sum_{i=1}^p\mu_jh_j(x)$$

Функция 
$$g(\mu,\lambda)=\inf_{x\in D}L(x,\mu,\lambda)$$
называется двойственной функцией Лагранжа.

## свойства двойственной функции

Двойственная функция является вогнутой как инфимум аффинных функций по $(\mu, \lambda)$ вне зависимости от того, является ли исходная задача выпуклой.

Для любого $\lambda$ и для $\mu \ge 0$ выполнено
$$g(\mu,\lambda)\le p^\ast$$

При минимизации лагранжиана получается оценка снизу на оптимальное значение.

## двойственная задача

$$\begin{aligned}
& \max g(\mu,\lambda)=d^\ast\\
\text{s.t. } &\mu\ge 0
\end{aligned}$$
По сути это оптимизация двойственной функции, при условии, что переменные $\mu$ и $\lambda$ допустимы.

Двойственная задача выпукла, независимо от того, выпукла ли прямая.

Максимизация вогнутой функции на выпуклом множестве — это выпуклая задача. Поэтому она может быть решена и значение $d^\ast$ может дать нижнюю границу для решения исходной задачи $p^\ast$. 

Нижняя оценка может достигаться.

Рассмотрим задачу
$$\begin{aligned}
& \min f_0(x)\\
\text{s.t. } &Ax\le b\\
&Cx=d
\end{aligned}$$
Тогда
$$\begin{aligned}
g(\lambda, \mu) &= \inf_x\big(f_0(x)+\lambda^T(Ax-b)+ \mu^T(Cx-d)\big)=\\
&= -b^T\lambda-\mu^Td+\inf_x\big(f_0(x)+(A^T\lambda+C^T\mu)^Tx\big)=\\
&= -b^T\lambda-\mu^Td+f_0^\ast(-A^T\lambda-C^T\mu)
\end{aligned}$$
области определений
$$\text{dom }g=\{(\lambda,\mu)|-A^T\lambda-C^T\mu\in\text{dom }f_0^\ast\}$$

## условия Слейтера

**теорема**

Если задача выпуклая и существует $x$,  лежащий внутри допустимой области, т.е. ограничения типа неравенств выполнены как строгие неравенства, то выполнено свойство сильной двойственности.

## условия Каруша-Куна-Таккера

1. $g_i(x^\ast)=0$ — допустимость в прямой задаче
2. $h_j(x^\ast)\le 0$ — допустимость в прямой задаче
3. $\mu^\ast_j \ge 0$ — допустимость в двойственной задаче
4. $\mu_j^\ast h_j(x^\ast)=0$ — условие дополняющей нежесткости
5. $\nabla_x L(x^\ast,\lambda^\ast, \mu^\ast)=0$ — стационарность лагранжиана по прямым переменным

