# теоремы Холла и Кёнига

Представим, что есть $n$ молодых неженатых людей. У каждого из них есть некоторое количество девушек, на которых они могли бы жениться.

Образуется двудольный граф:

![[graphs_10.001.jpg]]

При этом полнота графа не предполагается.

При каких условиях можно гарантировать, что найдется такое *паросочетание* — такой способ сочетать каждого юношу с девушкой, чтобы девушка всегда была из изначального множества предпочтений юноши?

Паросочетание в графе $G=(V,E)$ — это любое *независимое множество ребер*, в котором никакие два ребра не имеют общих вершин.

## необходимое условие существования паросочетания

Если объединить множества предпочтений всех молодых людей мощности $k \le n$, то для существования паросочетания заведомо необходимо, чтобы мощность полученного объединения, то есть суммарное количество девушек, из которых хотя бы один готов выбирать, было не меньше $k$.

$V_1$ — это верхняя доля вершин, которая содержит молодых людей, возьмем подмножество этого множества
$$A\subseteq V_1=\{1,2,\ldots,n\}$$
$N_G(A)$ — множество соседей множества $A$
$$N_G(A):=\{v\in V_2: \exists w\in A:(v,w)\in E\}$$
Необходимое условие (**условие Холла**) в этих терминах:
$$\forall A\subseteq V_1 \ |N_G(A)|\ge|A|$$
Это условие является достаточным.


## теорема Холла

Паросочетание в двудольном графе, покрывающее все вершины доли $V_1$, существует тогда и только тогда, когда выполнено условие Холла.

*Доказательство*

Индукция по размеру доли $|V_1|$. 

*База индукции*. $|V_1|=1$, мощность $|V_2|$ — любая. В множестве вершин из одного элемента есть только одно содержательное подмножество — сама же вершина. Количество предпочтительных вершин $V_2$ точно не меньше единицы.

*Шаг индукции.* Предположим, что для каждой верхней доли, размер которой не превосходит $|V_1 |\le k$ и для абсолютно любой нижней доли, если выполнено условие Холла, то паросочетание есть.

Докажем, что то же самое верно для любого $|V_1|=k+1$.

Рассмотрим два случая. 
1. Для любого собственного $A \subsetneq V_1$  мощность $|A|<|N_G(A)|$. 
2. Существует собственное подмножество $A \subsetneq V_1$ у которого $|A|=|N_G(A)|$.

### случай 1

Рассмотрим произвольную вершину $a\in V_1$, у которой есть хотя бы одна соседка среди вершин $V_2$. Возьмем любую вершину $b\in V_2$, такую, что пара $(a,b)$ образует ребро в графе $G$.

Удалим из исходного графа $G$ вершины $a$ и $b$,  так как они образовали пару. Проверим, что для оставшегося графа тоже выполнено условие Холла.

Рассмотрим произвольное множество вершин $A$ из $V_1$ без вершины $a$
$$A \subseteq V_1-\{a\}$$
Это множество $A$ является собственным подмножеством множества $V_1$, потому что у него нет $a$, значит с $V_1$  оно совпадать не может
$$A\ne V_1$$
По условию $|A|<|N_G(A)|$. Даже если $b \in N_G(A)$, то при удалении $b$ мощность $N_G(A)$ уменьшится не больше, чем на единицу
$$|A|\le |N_G(A)|-1$$
Обозначим оставшийся граф $G'$, тогда
$$|N_{G'}(A)|\ge|N_G(A)|-1$$
и выходит, что 
$$|A|\le |N_G(A)|-1\le |N_{G'}(A)|$$
Условие Холла выполняется для $G'$. Тогда есть паросочетание, покрывающее множество вершин $V_1-\{a\}$. Значит, вместе с изначально удаленным ребром, получено полное паросочетание, покрывающее всё $V_1\in G$.

### случай 2

![[graphs_10.002.jpeg]]

Пусть $G_1$ — это подграф исходного графа $G$, порожденный долями $A$ и $N_G(A)$. С очевидностью для $G_1$ выполнено условие Холла.

Поскольку множество $A$ является собственным подмножеством множества $V_1$, то его мощность $|A| < |V|$ или $|A| \le k$. Значит к $G_1$ можно применять предположение индукции. Следовательно, по предположению индукции существует паросочетание из $A$ в $N_G(A)$, которое покрывает $A$.

Обозначим $A'$ множество $V_1$ без $A$ и $B'$ — множество $V_2$ без $N_G(A)$.  Пусть $G_2$ порожден долями $A'$ и $B'$.

Если взять множество $U\subseteq A'$, то нет никаких гарантий, что его соседи лежат строго в $B'$. 
![[graphs_10.003.jpg]]

Предположим, что $|N_{G_2}(U)|< |U|$. Тогда в исходном графе $G$ рассмотрим окрестность объединения $N_G(A\cup U)$. Она точно содержит внутри себя $N_G(A)$
$$|N_G(A\cup U)|=|N_G(A)|+ |N_{G_2}(U)|<|A|+|U|=|A\cup U|$$
Получается, что в исходном графе $G$ нашлось некоторое множество $A \cup U$, у которого размер окрестности строго меньше, чем размер самого множество. А это противоречит условию Холла для самого графа. Значит предположение неверно и для графа $G_2$ выполняется условие Холла.