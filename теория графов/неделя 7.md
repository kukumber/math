# формула числа унициклических графов

Унициклический граф — это связный граф, в котором присутствует только один простой цикл.

**Теорема**
$$U_n=\sum_{r=3}^nC_n^r\frac{r!}{2}\cdot n^{n-r-1}$$ ***Следствие из теоремы.***
$$U_n\sim\sqrt{\frac{\pi}{8}}\cdot n^{n-\frac{1}{2}}$$
Это означает, что, если количество унициклических графов поделить на эту величину, то при $n\to\infty$ в пределе будет единица.

***Доказательство теоремы***

Прежде всего выберем цикл, который присутствует в унициклическом графе, $r$ — длина этого цикла. Если цикл простой, то у него как минимум три вершины. Число способов выбрать $r$ вершин для цикла
$$C_n^r$$
Для каждого из способов количество вариантов зациклить $r$ вершин составляет
$$\frac{(r-1)!}{2}$$
Теперь в каждой вершине будет дерево. Если удалить из унициклического графа его единственный простой цикл, то останется лес, имеющий $r$ компонент связности ($r$ деревьев), имеющий $n$ вершин, и такой, что вершины $1,2,\ldots,r$ принадлежат разным компонентам связности.
$$\sum_{r=3}^nC_n^r\frac{(r-1)!}{2}F(n,r)$$
***лемма***
$$F(n,r)=rn^{n-r-1}$$

# Эйлеровы циклы

Граф $G$ содержит эйлеров цикл если существует вершина, начав с которой можно пройти по всем ребрам ровно по одному разу и вернуться в эту же вершину.

**Теорема**

Для связного графа $G$ следующие три утверждения являются эквивалентными:
1. $G$ является эйлеровским
2. Степень каждой вершины графа $G$ чётная
3. Множество ребер графа $G$ распадается в дизъюнктное (попарно непересекающееся) объединение простых циклов


***Доказательство***

$1 \Rightarrow 2$ очевидно

$2 \Rightarrow 3$ 

Возьмем связный граф $G=(V,E)$. Каждая вершина имеет четную степень. Возьмем вершину $x_1$. Из нее выходит хотя бы одно ребро и идет в вершину $x_2$. Так как у вершины четная степень, то помимо ребра $(x_1,x_2)$ есть еще одно ребро, исходящее из вершины $x_2$, например $(x_2, x_3)$.  Может случиться, что следующее ребро идет из $x_3$ в $x_1$, тогда случится простой цикл.
![[graph_08.001.png]]
Рано или поздно какая-то вершина $x_n$ не отправит ребро дальше, потому что вершины будут исчерпаны, а отправит в одну из предыдущих вершин и будет найден первый простой цикл $Z_1$. Удалим из графа ребра этого цикла. Получившийся граф может остаться связным, а может потерять связность.

Допустим, он получился несвязным. Рассмотрим любую компоненту связности. У нее степень всех вершин четная, потому как, если был удален простой цикл, то у каждой вершины степень уменьшилась на два.

Произведем в точности те же рассуждения, что и для исходного графа $G$, и найдем еще один простой цикл, который обозначим $Z_2$. Очевидно, что ребра цикла $Z_2$ не имеют ничего общего с ребрами цикла $Z_1$.

Продолжаем эту процедуру до тех пор, пока не исчерпаются все ребра исходного графа $G$.


$3 \Rightarrow 1$ 

$G=(V,E)$ множество ребер — это объединение непересекающихся простых циклов.

Индукция по числу простых циклов.

*База индукции* — случай, когда количество простых циклов — 1. Очевидно, что такой граф можно обойти.

*Предположение индукции*. Утверждение доказано для любого $k\le n$. Рассмотрим граф $G$, у которого $k=n+1$ непересекающихся простых циклов. Зафиксируем один из циклов $Z$.

Рассмотрим граф $H$, который получается из графа $G$ путем удаления ребер цикла $Z$. Обозначим получившиеся компоненты связности $H_1, \ldots, H_m$.

Стартуем с произвольной вершины $x\in Z$. Эта вершина $x$ принадлежит в графе $H$ какой-то компоненте связности $x\in H_1$. $H_1$ разбита на не более, чем $n$ непересекающихся простых циклов. Применяем предположение индукции к $H_1$ и обходим всю компоненту, возвращаясь в $x$. Двигаемся дальше по ребрам $Z$, если следующая вершина по-прежнему в $H_1$, то двигаемся дальше по $Z$, пока не встретим другую компоненту связности $H_2$. Повторяем предполжение индукции. Повторяем процесс, пока не вернемся к первой вершине $x$.