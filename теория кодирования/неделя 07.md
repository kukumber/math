	# коды Рида—Маллера

Коды Рида-Маллера — двоичные. При их построении берутся многочлены не от одной, а от многих переменных. 

У кодов Рида-Маллера есть два параметра $(r, m)$, где $r\le m$. Все стандартные параметры выражаются через эти два числа.

Коды определяются так: берем поле $\mathbb{F}_2$ и рассматриваем многочлены от $m$ переменных с коэффициентами из $\mathbb{F}_2$
$$P\in\mathbb{F}_2[x_1,\ldots,x_m]$$
Эти многочлены имеют ограниченную степень:
$$\deg P\le r$$
Каждый многочлен вычисляем во всех возможных точках. Раз многочлен от $m$ переменных, то это значит, что точка — это набор из $m$ переменных. Фактически берется вектор из $2^m$ значений многочлена
$$\big(P(0\ldots 00),P(0\ldots 01),\ldots, P(1\dots11) \big)$$
Все эти значения образуют длинное кодовое слово. Таким образом, длина кода Рида-Маллера равна $2^m$.

Код тривиально линейный, потому что, если рассмотреть линейную комбинацию двух кодовых слов, то она соответствует тому, что, если взять линейную комбинацию двух многочленов и вычислить значение этой линейной комбинации во всех точках, то получится некоторое кодовое слово.

Когда вычисляем многочлены из $\mathbb{F}_2$ и вычисляем их на наборах из 0 и 1, то степени у переменных нет смысла брать больше 1. Потому что в этом случае, например, моном:
$$x_5^{7}x_{10}^{17}$$
это тоже самое, что:
$$x_5x_{10}$$
Многочлен можно записать, как линейную комбинацию мономов степени не выше $r$. То есть, многочлены, которые рассматриваются при построении кодов Рида-Маллера, образуют линейное пространство многочленов. Базис этого линейного пространства — множество всех возможных мономов степени не выше $r$:
$$\begin{aligned}
&\{1\} \cup \\
&\cup\{x_1, x_2, \ldots,x_m\}\cup \\
&\cup\{x_1x_2, x_1x_3,\ldots,x_{m-1}x_m\} \cup\\
&\vdots\\
&\cup\{x_{i_1}x_{i_2}\ldots x_{i_r}|1\le i_1,\ldots i_r\le m\}
\end{aligned}$$
Размерность этого пространства:
$$k=\sum_{t\le r}\binom{m}{t}$$
Линейное пространство кодов Рида-Маллера имеет ту же размерность, что и линейное пространство многочленов.

## лемма

Если $P$ — это многочлен от нескольких переменных 
$$P\in \mathbb{F}_2[x_1,\ldots, x_m],P\not\equiv 0$$и имеющий степень не выше $r$ $\deg P \le r$, тогда количество наборов из нулей и единиц длины $m$, на которых многочлен равен единице, оценивается снизу:
$$\#\big\{(s_1,\ldots, s_m)\in \mathbb{F}_2^m|P(s_1,\ldots,s_m)=1\big\}\ge 2^{m-r}$$
При этом $2^{m-r}$ оказывается кодовым расстоянием $d(C)$.

**доказательство**

Индукция по $m$.

База индукции, когда $m=1$. В этом случае есть константный многочлен.

Первый вариант, $P=1$, в этом случае $2^{m-r}=2^1$, потому что $m=1, r=0$.

Второй вариант, когда многочлен зависит от одной переменной — это два варианта: многочлен $x_1$, либо $x_1+1$. В обоих случаях есть ровно один набор, на котором этот многочлен равен единице. Тогда $2^{1-1}=1$. 

Индуктивный переход. Рассмотрим многочлен, зависящий хотя бы от двух переменных. Предположим, что он зависит от $m$-й переменной. Тогда можно взять все мономы, в который входит переменная $x_m$ и вынести эту переменную за скобки. Тогда в скобках останется многочлен, зависящий от $m-1$ переменной. В исходном многочлене могли быть мономы, которые не содержали переменную $x_m$, их сгруппируем отдельно и назовем $P_1$.
$$P(x_1,\ldots, x_m)=P_1(x_1,\ldots,x_{m-1})+x_mP_2(x_1,\ldots,x_{m-1})$$
Степень многочлена $P_1$ не выше $r$.

Степень многочлена $P_2$ не выше степени $r-1$. Потому что, если бы это было не так, и нашелся бы моном большей степени, то этот моном мог бы быть степени $r$ и этот моном содержал бы переменные от $x_1$ до $x_{m-1}$. После домножения на $x_m$ получился бы некоторый моном, $r+1$ степени. Но поскольку этот моном содержит $x_m$, а в $P_1$ нет монома, содержащего $x_m$, то этот моном в итоге попал бы в многочлен $P$, который оказался бы степени $r+1$, а это противоречит построению.

Воспользуемся этим. Применим предположение индукции к многочлену $P_2$. Число наборов значений переменных, на которых $P_2$ обращается в единицу, не меньше:
$$\# \big\{(s_1, \ldots, s_{m-1})|P_2(s_1,\ldots, s_{m-1})=1\big\}\ge2^{(m-1)-(r-1)}=2^{m-r}$$
Если $P_1(s_1,\ldots,s_{m-1})=0$, то возьмем набор $(s_1, \ldots, s_{m-1}, 1)$
Если $P_1(s_1,\ldots,s_{m-1})=1$, то возьмем набор $(s_1, \ldots, s_{m-1}, 0)$

## декодирование кодов Рида—Маллера

Код Рида-Маллера с параметрами $(r, m)$ является кодом
$$\bigg[2^m, \sum_{t\le r}\binom{m}{t},2^{m-r}\bigg]$$
может исправлять вплоть до $(2^{m-r-1}-1)$ ошибок.

Постановка задачи:
- В векторе кода Рида-Маллера изменяются менее $2^{m-r-1}$ координат.
- Восстановить по искаженному вектору значений исходный многочлен.

Восстановить многочлен — это значит восстановить коэффициенты перед мономами этого многочлена. Кодовое слово — значение многочлена, выразимого в базисе
$$\{1\}\cup\{x_1, x_2, \ldots, x_m\}\cup\ldots\cup\{x_{i_1},x_{i_2}\ldots x_{i_r}|1\le i_1, \ldots, i_r\le m\}$$
Восстановить кодовое слово — это то же, что найти коэффициенты этой линейной комбинации.

### лемма

Пусть есть многочлен $P\in \mathbb{F}_2[x_1,\ldots,x_r]$, зависящий от $r$ переменных. Коэффициент при самом старшем мономе в этом многочлене может быть найден как сумма значений многочлена на всех возможных точках:
$$\text{coef}_{x_1\cdot\ldots\cdot x_r}P=\sum_{\alpha_1,\ldots, \alpha_r\in\mathbb{F}_2}P(\alpha_1,\ldots,\alpha_r)$$

**доказательство**

Представим многочлен $P$ в следующем виде
$$P=c\cdot x_1\ldots x_r + P_1 + \ldots+P_r$$
Если многочлен от $r$ переменных, то все мономы степени которых меньше $r$ теряют хотя бы одну переменную. Возьмем все мономы, в которые не входит переменная $x_1$ и сгруппируем их, назвав $P_1$ и так далее, то есть $x_i$ не входит в $P_i$.

Просуммируем это равенство по всем возможным наборам значений
$$\sum_{\alpha_1,\ldots,\alpha_r\in \mathbb{F}_2}P(\alpha_1,\ldots,\alpha_r)=\sum_{\alpha_1,\ldots,\alpha_r\in \mathbb{F}_2}c \cdot\alpha_1,\ldots,\alpha_r+\sum_{1\le i \le r}\sum_{\alpha_1,\ldots,\alpha_r\in \mathbb{F}_2}P_i(\alpha_1,\ldots,\alpha_r)$$
В первом слагаемом константу $c$ можно вынести за знак суммы и тогда все $\alpha$ равны 1. Потому что, если хотя бы одна $\alpha$ равна 0, то произведение обнуляется. То есть первое слагаемое полностью равно $c$.

Каждая сумма $\sum_{\alpha_1,\ldots,\alpha_r\in \mathbb{F}_2}P_i(\alpha_1,\ldots,\alpha_r)=0$

Когда берется многочлен $P_i$, в который не входит $x_i$  и значение этого многочлена суммируется по всем возможным наборам $\alpha$. Сумму можно сгруппировать по парам и каждая из них будет выглядеть так:
$$\begin{aligned}
&\sum_{\alpha_1,\ldots,\alpha_r\in \mathbb{F}_2}P_i(\alpha_1,\ldots,\alpha_r)=\\
&=\sum_{\alpha_1,\ldots,\alpha_{i-1},\alpha_{i+1},\ldots,\alpha_r\in \mathbb{F}_2}\big(P_i(\alpha_1,\ldots,\alpha_{i-1},0,\alpha_{i+1},\ldots,\alpha_r)+P_i(\alpha_1,\ldots,\alpha_{i-1},1,\alpha_{i+1},\ldots,\alpha_r)\big)
\end{aligned}$$
Слагаемые в скобках равны. Их сумма по модулю 2 равна нулю.

### первый шаг алгоритма

Пусть $\deg P\le r$. Забьем константами какие-то $(m-r)$ переменных
$$P_{\beta_1,\ldots,\beta_{m-r}}=P(x_1,\ldots,x_r,\beta_1,\ldots,\beta_{m-r})$$
Это многочлен, который зависит от $r$ переменных. Моном старшей степени $x_1 \ldots x_r$. В этом многочлене не останется мономов, в которых номер больше $r$. Применим лемму
$$\sum_{\alpha_1,\ldots,\alpha_r\in \mathbb{F}_2}P_{\beta_1,\ldots,\beta_{m-r}}(\alpha_1,\ldots,\alpha_r)=\text{coef}_{x_1\cdot\ldots\cdot x_r}P_{\beta_1,\ldots,\beta_{m-r}}$$
Эта формула никак не зависит от того, какие именно константы $\beta_1,\ldots,\beta_{m-r}$ мы подставляем вместо оставшихся переменных.

Дано слово
$$\big(P(0\ldots0),P(0\ldots01),P(0\ldots10),P(0\ldots11),\ldots,P(1\ldots11)\big)$$
Некоторые значение слова могут искажаться. Возьмем принятое из канала слова и запишем много формул для одного и того же коэффициента
$$\begin{aligned}
\text{coef}_{x_1\cdot\ldots\cdot x_r}P&=\sum_{\alpha_1,\ldots,\alpha_r\in\mathbb{F}_2}P(\alpha_1,\ldots,\alpha_r0,\ldots,0,0) \\
\text{coef}_{x_1\cdot\ldots\cdot x_r}P&=\sum_{\alpha_1,\ldots,\alpha_r\in\mathbb{F}_2}P(\alpha_1,\ldots,\alpha_r0,\ldots,0,1) \\
\text{coef}_{x_1\cdot\ldots\cdot x_r}P&=\sum_{\alpha_1,\ldots,\alpha_r\in\mathbb{F}_2}P(\alpha_1,\ldots,\alpha_r0,\ldots,1,0) \\
&\vdots\\
\text{coef}_{x_1\cdot\ldots\cdot x_r}P&=\sum_{\alpha_1,\ldots,\alpha_r\in\mathbb{F}_2}P(\alpha_1,\ldots,\alpha_r1,\ldots,1,1) \\
\end{aligned}$$
Таких формул получается $2^{m-r}$.

В пришедшем из канала слова искажен не больше, чем $(2^{m-r-1}-1)$ разряд. Каждое из $P$ участвует только в одной формуле. 

В идеале, при подстановке слова в эти формулы, каждая давала бы единицу. Из-за искажений в некоторых местах вместо единицы может получаться ноль. Всего будет искажено меньше половины значений. Значит можно взять и посмотреть, какое наиболее часто встречается. Оно и будет тем, которое должно в идеале быть выдано каждой формулой.

### полный алгоритм

Пусть уже найдены все $\text{coef}_{x_{i_1}\cdot\ldots\cdot x_{i_r}}P$ .

Рассмотрим многочлен, содержащий все мономы исходного многочлена $P$, степени не выше $(r-1)$:
$$P_{[r-1]}:=P-\sum_{i_1,\ldots, i_r}\big(\text{coef}_{x_{i_1}\cdot\ldots\cdot x_{i_r}}P\big)\cdot x_i\ldots x_{i_r}$$
Рассмотрим $P_{[r-1]}(t_1,\ldots,t_m)$:
$$P(t_1,\ldots,t_m)-\sum_{i_1,\ldots,i_r}\big(\text{coef}_{x_{i_1}\cdot\ldots\cdot x_{i_r}}P\big)\cdot t_i\ldots t_{i_r}$$
На выходе из канала есть слово, представляющее собой значение многочлена $$\big(P(0\ldots 00),P(0\ldots 01),\ldots, P(1\dots11) \big)$$
Коэффициенты уже известны. Берем каждое значение $P$, например, $P(0\ldots 00)$ и подставляем в $t_i\ldots t_{i_r}$. Получаем то, чему должна была бы в идеале равняться вот эта часть:
$$\sum_{i_1,\ldots,i_r}\big(\text{coef}_{x_{i_1}\cdot\ldots\cdot x_{i_r}}P\big)\cdot t_i\ldots t_{i_r}$$
Значение $P(0\ldots 00)$ у нас записано, вычитаемое тоже есть. Если исходно величина $P(0\ldots 00)$ была принята без искажений, то разность будет получена тоже без искажений.

Получается вектор $P_{[r-1]}$, в котором какие-то значения могут быть неправильными, которых будет меньше половины. К многочлену может быть применена ключевая лемма. Теперь можно посчитать значения коэффициентов степени не выше $(r-1)$. Затем можно перейти к следующему шагу.

### алгоритм

- определяем все $\text{coef}_{x_{i_1}\cdot\ldots\cdot x_{i_r}}P$
- рассматриваем
$$P_{[r-1]}:=P-\sum_{i_1,\ldots, i_r}\big(\text{coef}_{x_{i_1}\cdot\ldots\cdot x_{i_r}}P\big)\cdot x_i\ldots x_{i_r}$$
- определяем все $\text{coef}_{x_{i_1}\cdot\ldots\cdot x_{i_{r-1}}}P$ 
- рассматриваем
$$P_{[r-2]}:=P_{[r-1]}-\sum_{i_1,\ldots, i_{r-1}}\big(\text{coef}_{x_{i_1}\cdot\ldots\cdot x_{i_r}}P\big)\cdot x_i\ldots x_{i_{r-1}}$$
- определяем все $\text{coef}_{x_{i_1}\cdot\ldots\cdot x_{i_{r-2}}}P$ 
- и т. д.

# лемма Липтона—Демилло—Шварца—Зиппеля

Пусть $P\in\mathbb{F}[x_1,\ldots,x_m]$ и $P\not\equiv 0$.

Пусть $S\subseteq \mathbb{F}$ — произвольное множество мощности $N$.

Тогда количество наборов $(s_1,\ldots,s_m)$, на которых многочлен равен нулю, где каждое значение выбирается из множества $S$, не слишком велико:  
$$\#\big\{(s_1,\ldots,s_m)\in S^m | P (s_1, \ldots, s_m)=0\big\}\le N^{m-1}\cdot \deg P$$
Если положить $m=1$, то есть многочлен одной переменной. Берем какое-то множество. Число отдельных значений, на которых многочлен равен нулю, не превосходит $$N^0\cdot \deg P=\deg P$$
В этом случае теорема превращается в теорему Лагранжа о том, что многочлен не может иметь больше корней, чем степень этого многочлена.

**доказательство**

База $m=1$.

Индуктивный переход. Считаем, что многочлен зависит от $m$-й переменной. Разложим многочлен по этой переменной. Возьмем переменную в самой старшей степени $t$:
$$P(x_1,\ldots,x_m)=\sum_{k=0}^t x_m^k \cdot P_k(x_1, \ldots,x_{m-1})$$
Обозначим множество, представляющее собой наборы длины $(m-1)$ из множества $S$, на которых обнулился многочлен $P_t$:
$$\hat{S}:=\big\{(s_1,\ldots,s_{m-1})\in S^{m-1}|P_t(s_1, \ldots, s_{m-1})=0\big\}$$
Из предположения индукции, количество нулей не превосходит:
$$|\hat{S}|\le N^{m-2}\cdot\deg P_t\le N^{m-2}\cdot(\deg P-t)$$
Рассмотрим величину, разбив наборы на два типа:
$$\begin{aligned}
&\big|\big\{(s_1,\ldots,s_{m-1})\in S^{m-1}|P_t(s_1, \ldots, s_{m-1})=0\big\}\big| = \\
& = \big|\big\{(s_1,\ldots,s_m)|P(s_1, \ldots, s_m)=0 \wedge (s_1, \ldots, s_{m-1})=0 \in \hat{S}\big\}\big| + \\
& + \big|\big\{(s_1,\ldots,s_m)|P(s_1, \ldots, s_m)=0 \wedge (s_1, \ldots, s_{m-1})=0 \notin \hat{S}\big\}\big| \le\\
&\le|\hat{S}|\cdot N +(N^{m-1}-|\hat{S}|)\cdot t \le|\hat{S}|\cdot N+ N^{m-1}\cdot t \le \\
& \le N^{m-1}\cdot(\deg P-t)+N^{m-1}\cdot t=N^{m-1}\cdot\deg P
\end{aligned}$$
## вероятностная формулировка леммы ЛДШЗ

Пусть $P\in\mathbb{F}[x_1,\ldots,x_m]$ и $P\not \equiv 0$.

Если $s_1, \ldots s_m$ выбираются равновероятно и независимо из некоторого множества мощности $N$, то
$$Pr\{P(s_1, \ldots, s_m)=0\}\le\frac{\deg P}{N}$$

### пример

Пусть $\mathbb{F}_q=\{t_1, \ldots, t_1\}$.

Множество
$$C:=\bigg\{\big(P(t_1,t_1),P(t_1,t_2)\ldots P(t_q,t_q)\big)| P(x,y)=\sum_{0\le i,j\le l}\alpha_{ij}x^iy^j\bigg\}$$
образует $[q^2,l^2,d]$-код, где $d\ge q(q-2l)$.

# в общих чертах о кодах Гоппы

Идея: $t_1,\ldots, t_n$ — нули многочлена $P_{\text{base}}$ небольшой степени.

Многочлены, по которым строится $C$ — многочлены, имеющие мало общих нулей  с $P_{\text{base}}$.

**Пример:**
В $\mathbb{F}_{13}$ берем
$$P_{\text{base}}:=y^2-2x^3+2x$$
Множество нулей $P_{\text{base}}$:
$$P_{\text{base}}=\{(0,0),(\pm1;0), (2;\pm5),(3;\pm3),(4;\pm4),(6;\pm2),(7;\pm3),(9;\pm6),(10;\pm2),(11;\pm1)\}$$
$$q:=13$$
$$n:=|S_{\text{base}}|=19$$
Рассмотрим множество многочленов:
$$\tilde{P}:=\{\alpha_1+\alpha_2x+\alpha_3x^2+\alpha_4x^3+\alpha_5y+\alpha_6xy\}$$
### лемма

Если $P\in\tilde{P}$ и $P\not\equiv 0$, то у многочленов $P$ и $P_{\text{base}}$ не больше шести общих нулей.

**следствие**

Множество 
$$C:=\bigg\{P(x_0,y_0)_{(x_0,y_0)\in S_{\text{base}}}|P\in\tilde{P}\bigg\}$$
является $[19,6,13]_{13}$-кодом.
