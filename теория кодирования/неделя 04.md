# граница Плоткина для двоичного случая

Если $N< 2d$, то для любого кода $C\subset \{0,1\}^N$, такого, что $d(C)=d$
$$|C|\le \frac{2d}{2d-N}$$

## матрица Адамара

Матрица Адамара — это матрица из $\{-1, 1\}^{n\times n}$, в которой любые две строки ортогональны.

Примеры:
$$\begin{pmatrix}
1 & 1 \\
1 & -1
\end{pmatrix}$$
$$\begin{pmatrix}
1 & 1 & 1 & 1 \\
1 & 1 & -1 & -1 \\
1 & -1 & -1 & 1 \\
1 & -1 & 1 & -1
\end{pmatrix}$$

## теорема Адамара

Если $A=(a_{ij})_{1\le i,j \le n}\in \mathbb{R}^{n\times n}$ и $|a_{ij}|\le 1$ для любых $i,j$ то тогда 
$$|\det A|\le n^{n/2}$$

Значение определителя матрицы по модулю равно объему параллелепипеда, который построен на строчках матрицы, как на векторах. Объем параллелепипеда зависит от длин сторон. При фиксированных длинах сторон его объем максимален тогда, когда этот параллелепипед прямоугольный. При указанных ограничениях максимальная длина параллелепипеда может быть при максимальной норме вектора $\sqrt{n}$. Для того, чтобы достичь такой длины компоненты вектора по модулю должны быть равны единице.

Если параллелепипед прямоугольный, то его объем равен произведению длин отдельных векторов. Каждый вектор имеет норму $\sqrt{n}$, а всего векторов столько, какова размерность пространства — $n$. Получается, что объем параллелепипеда равен $n^{\sqrt{n}}$.

Адамаровость матрицы сохраняется при
- перестановках строк/столбцов
- умножении строк/столбцов на -1

Матрицы Адамара, получаемые друг из друга такими преобразованиями, *эквивалентны*.

Любую матрицу Адамара умножением строк/столбцов на -1 можно привести к матрице, у которой первая строка и столбец целиком состоят из +1:
$$\begin{pmatrix}
1 & 1 & \cdots & 1 \\
1 \\
\vdots \\
1
\end{pmatrix}$$
Такая матрица Адамара называется *нормализованной*.

**утверждение**

Если $H\in\{-1,1\}^{n\times n}$ — матрица Адамара, и порядок матрицы $n >2$, то этот порядок точно делится $4|n$.

Возьмем произвольную матрицу, порядок которой больше 2

Нормализуем матрицу так, чтобы вся первая строчка и первый столбец состояли из +1
![[неделя 04.png]]
Переставим строки матрицы таким образом, чтобы на втором месте оказалась строка, у которой все элементы, равные +1, оказались сдвинуты влево. 

Во второй группе столбцов, где во второй строке +1, переставим столбцы так, чтобы в третьей строке все +1 оказались слева. 

Затем в той части, где вторая строка отрицательна, переставим столбцы так, чтобы слева оказались отрицательные, а справа — положительные.

Количество положительных элементов в третьей строке обозначим $i,k$, отрицательных — $j,l$.

Сумма этих чисел равна порядку матрицы $n$. Скалярные произведения строк
$$\begin{cases}
i+j+k+l = n\\
i + j -k-l=0\\
i-j-k+l=0 \\
i-j+k=l=0
\end{cases}$$
У этой системы единственное решение
$$i=j=k=l=\frac{n}{4}$$

## гипотеза Адамара

Матрицы Адамара порядка $n$ существуют для всех натуральных $n$, кратных четырем.


**утверждение**
Матрица Адамара порядка $n$ существует для любого $n=2^k$.

**доказательство**
Если $H$ — матрица Адамара, то матрицей Адамара будет и такая
$$\begin{pmatrix}
H & H \\
H & -H
\end{pmatrix}$$
Матрица Адамара при $k=1$ существует 
$$\begin{pmatrix}
1 & 1 \\
1 & -1
\end{pmatrix}$$

## теорема Пэли

Если $p\in \mathbb{P}$ и $4|(p^m +1)$, то существует матрица Адамара порядка $(p^m +1)$.

$p$ — простое число, $m$  — натуральное число.

## конечные поля

Конечное поле $\mathbb{F}_q$ — это $q$-элементное подмножество, элементы которого можно складывать и умножать, так, что:
- сложение и умножение подчиняются переместительному и сочетательному законам
- распределительный закон умножения относительно сложения
- в $\mathbb{F}_q$ есть два элемента 0 и 1, такие, что $0+a=a$ для любого $a\in\mathbb{F}_q$  и $1\cdot b=b$ для любого $b\in\mathbb{F}_q\backslash \{0\}$
- уравнение вида $a+x=b$ разрешимо для любых $a,b\in\mathbb{F}_q$
- уравнение вида $a\cdot x=b$ разрешено для любых $a\in \mathbb{F}_q\backslash \{0\}$ и $b\in \mathbb{F}_q$

Факты:
- для любого $p\in\mathbb{P}$ и любого $m\in\mathbb{N}$ существует конечное поле $\mathbb{F}_{p^m}$
- при $m=1$ можно рассмотреть $\mathbb{F}_p=\mathbb{Z}_p$

### примитивные элементы

В любом поле $\mathbb{F}_q$ существует *примитивный элемент* $\lambda$, такой, что 
$$\mathbb{F}_q=\{0\}\cup\{\lambda,\lambda^2,\ldots,\lambda^{q-1}\}$$
Пример:
- рассмотрим $\mathbb{F}_7=\mathbb{Z}_7=\{0,1,2,3,4,5,6\}$
- $\{0\}\cup\{3, 3^2, 3^3, 3^4, 3^5, 3^6\}=\{0\}\cup\{3,2,6,4,5,1\}=\mathbb{Z}_7$

### квардратичные вычеты

Элемент $a\in\mathbb{F}_q\backslash\{0\}$ называется *квадратичным вычетом*, если $a=x^2$ для некоторого $x\in\mathbb{F}_q$

Остальные элементы из $\mathbb{F}_q\backslash\{0\}$ называются *квадратичными невычетами*.

Пример: в $\mathbb{Z}_7$ элементы $1,2,4$ — квадратичные вычеты, а $3,5,6$ — квадратичные невычеты.

**утверждение**

- если $\lambda$ — примитивный элемент $\mathbb{F}_q$, то элементы вида $\lambda^{2t}$ являются квадратичными вычетами, а вида $\lambda^{2t+1}$ — квадратичными невычетами
- если $q=p^m$ и $p>2$, то ровно половина элементов из $\mathbb{F}_q\backslash\{0\}$ являются квадратичными вычетами

### символ Лежандра

$$\chi(a)=\begin{cases}0, & \text{if } a=0 \\
1, & \text{if } a \text{ к.в.} \\
-1, & \text{if } a \text{ к.н.}
\end{cases}$$

**утверждение**

Для любых $a,b\in\mathbb{F}_q$ выполнено равенство
$$\chi(a)\cdot\chi(b)=\chi(ab)$$

Например, $\chi(a)=1$ и $\chi(b)=1$.

Если $\chi(a)=1$, то $a$ — это квадратичный вычет и оно равно примитивному элементу поля $\lambda^{2t}$.

Если $\chi(b)=1$, то $b$ — это квадратичный вычет и оно равно примитивному элементу поля $\lambda^{2r}$.

Тогда произведение $\chi(ab)= \chi({\lambda^{2(t+r)}}$ ), то есть это некоторая четная степень примитивного элемента, то есть — это квадратичный вычет и значит $\chi(ab)=1$.

Аналогично, если $\chi(a)=-1$ и $\chi(b)=1$. 

Если $\chi(a)=-1$, то $a$ — это квадратичный невычет и оно равно примитивному элементу поля $\lambda^{2t+1}$.

Если $\chi(b)=1$, то $b$ — это квадратичный вычет и оно равно примитивному элементу поля $\lambda^{2r}$.

Тогда произведение $\chi(ab)= \chi({\lambda^{2(t+r)+1}}$ ), то есть это некоторая четная степень примитивного элемента, то есть — это квадратичный невычет и значит $\chi(ab)=-1$.


**утверждение**

Для любого $c \in \mathbb{F}_q\backslash\{0\}$ имеет место равенство
$$\sum_{b\in\mathbb{F}_q}\chi(b)\cdot\chi(b+c)=-1$$
**доказательство**

Если просуммировать значения символа Лежандра на всех элементах поля, получим ноль
$$\sum_{a\in\mathbb{F}_q}\chi(a)=0$$
потому что все элементы поля разбиваются на три класса: ноль, квадратичные вычеты и квадратичные невычеты, которых поровну.

Далее, заметим, что можно исключить ноль:
$$\sum_{b\in\mathbb{F}_q}\chi(b)\cdot\chi(b+c)=\sum_{b\in\mathbb{F}_q\backslash\{0\}}\chi(b)\cdot\chi(b+c)$$
Домножим $(b+c)$ на единицу в формате $b\cdot b^{-1}$
$$\sum_{b\in\mathbb{F}_q\backslash\{0\}}\chi(b)\cdot\chi(b+c)=\sum_{b\in\mathbb{F}_q\backslash\{0\}}\chi(b)\cdot\chi\big(b\cdot b^{-1}(b+c)\big)=$$
заметим, что символ Лежандра — мультпликативная функция
$$=\sum_{b\in\mathbb{F}_q\backslash\{0\}}\chi(b)\cdot\chi\big(b\cdot b^{-1}(b+c)\big)=\sum_{b\in\mathbb{F}_q\backslash\{0\}}\big(\chi(b)\big)^2\cdot\chi\big( b^{-1}(b+c)\big)=$$
так как у нас все элементы не равны нулю, то $\big(\chi(b)\big)^2=1$
$$=\sum_{b\in\mathbb{F}_q\backslash\{0\}}\big(\chi(b)\big)^2\cdot\chi\big( b^{-1}(b+c)\big)=\sum_{b\in\mathbb{F}_q\backslash\{0\}}\chi\big( b^{-1}(b+c)\big)=$$
теперь внесем $b^{-1}$ в скобку
$$=\sum_{b\in\mathbb{F}_q\backslash\{0\}}\chi\big( b^{-1}(b+c)\big)=\sum_{b\in\mathbb{F}_q\backslash\{0\}}\chi( 1+b^{-1}c)=$$
Так как $b$ пробегает все не нулевые элементы поля, то $b^{-1}$ тоже будет пробегать в каком-то порядке все элементы поля. Элемент $c$ не равен нулю, значит $b^{-1}c$ тоже будет пробегать все элементы поля, не равные нулю. Это значит, что $( 1+b^{-1}c)$ пробегает все элементы поля, не равные единице
$$=\sum_{b\in\mathbb{F}_q\backslash\{0\}}\chi( 1+b^{-1}c)=\sum_{a\in\mathbb{F}_q\backslash\{1\}}\chi(a)=$$
Просуммировать по всем не единичным элементам поля равносильно тому, что мы просуммируем все элементы поля и вычтем символ Лежандра 
$$=\sum_{a\in\mathbb{F}_q\backslash\{1\}}\chi(a)=\sum_{a\in\mathbb{F}_q}\chi(a)-\chi(1)=$$
так как $\chi(1)=1$, а $\sum_{a\in\mathbb{F}_q}\chi(a)=0$, получаем
$$=\sum_{a\in\mathbb{F}_q}\chi(a)-\chi(1)=-1$$

## матрица Якобшталя

Рассмотрим матрицу $(t_{a,b})_{a,b\in\mathbb{F}_q}\in\{-1,0,1\}^{q\times q}$, в которой $t_{a,b}:=\chi(a-b)$.

Строки и столбцы матрицы индексируются элементами поля. На диагонали у нее стоят нули.

Произведение различных строк $(t_{a',b})_{b\in\mathbb{F}_q}$и $(t_{a'',b})_{b\in\mathbb{F}_q}$ равно
$$\sum_{b\in\mathbb{F}_q}\chi(a'-b)\cdot \chi(a''-b)$$
Две различных строки соответствуют двум различным элементам поля $a'$ и $a''$. Скалярное произведение строчек — это сумма произведений пересечений столбца $b$ с каждой из строк.

В сумме $b$ пробегает все поле, а значит $(a'-b)$ тоже пробегает по всем элементам поля. Разница между $(a'-b)$ и $(a''-b)$ будет равна $(a''-a')$. Поэтому можно переписать сумму:
$$\sum_{b\in\mathbb{F}_q}\chi(a'-b)\cdot \chi(a''-b)=\sum_{b\in\mathbb{F}_q}\chi(b)\cdot \chi\big(b+(a''-a')\big)$$
Разность $(a''-a')$ — это какой-то элемент поля, отличный от нуля. Обозначим разность как $c\ne 0$. Если применить предыдущую лемму, то оказывается, что эта величина равна -1:
$$\sum_{b\in\mathbb{F}_q}\chi(a'-b)\cdot \chi(a''-b)=\sum_{b\in\mathbb{F}_q}\chi(b)\cdot \chi\big(b+(a''-a')\big)=-1$$
## «подправленная» матрица Якобшталя

Для того, чтобы перейти от матрицы Якобшталя к матрице Адамара, нужно сделать так:
- чтобы скалярное произведение каждых двух строк равнялось не -1, а 0
- чтобы на диагонали стояли не нули, а $\pm 1$ 

В исходной матрице Якобшталя на диагоналях строк $a'$ и $a''$ стояли нули:
![[неделя 04-1.png|w75]]

Запишем вместо нулей на диагонали $-1$, а все остальные элементы будут соответствовать исходному определению матрицы Якобшталя. 
![[неделя 04-2.png|w75]]
В исходной матрице скалярные произведения соответствующих элементов строк $a'$ и $a''$ были равны нулю
![[неделя 04-3.png|w75]]
Так как клетки диагональные, то это значит, что столбцы у нас выбраны также $a'$ и $a''$
![[неделя 04-4.png|w75|]]
В этих же столбцах находятся элементы $\chi(a''-a')$ и $\chi(a'-a'')$:
![[неделя 04-5.png|w75]]

То есть, скалярное произведение любых двух строчек $\big(t'_{a',b}\big){b\in\mathbb{F}_q}$  и $\big(t'_{a'',b}\big){b\in\mathbb{F}_q}$  равно
$$\bigg(\sum_{b\in\mathbb{F}_q}\chi(a'-b)\cdot\chi(a''-b)\bigg)-\chi(a'-a'')-\chi(a''-a')=$$
Так как вся сумма в скобках $\bigg(\sum_{b\in\mathbb{F}_q}\chi(a'-b)\cdot\chi(a''-b)\bigg)=-1$, то итоговое значение
$$=-1-\chi(a'-a'')-\chi(a''-a')$$

Допустим, $-1$ — это квадратичный вычет в поле $\mathbb{F}_q$. Тогда $(a''-a')$ можно представить как:
$$(-1)(a'-a'')=\chi(-1)\chi(a'-a'')=$$
если $-1$ — это квадратичный вычет, то $\chi(-1)=1$, в противном случае $\chi(-1)=-1$ и тогда
$$=-1-\chi(a'-a'')+\chi(a'-a'')=-1$$
В итоге скалярное произведение не поменялось.

Формально можно описать как 
$$T':=(t'_{a,b})_{a,b\in\mathbb{F}_q}\in\{-1,1\}^{q\times q}$$
где $t'_{a,b}=\chi(a-b)$, если $a\ne b$ и $t'_{a,b}=-1$ иначе.

Если $(-1)$ является квадратичным невычетом в $\mathbb{F}_q$, то скалярное произведение любых двух строк матрицы $T'$ равно $-1$.

Тогда матрица
$$\begin{pmatrix}
1 & 1 & \cdots & 1 \\
1 \\
\vdots & & T' \\
1
\end{pmatrix}$$
является нормализованной матрицей Адамара.

**утверждение**

При $4|(q+1)$  элемент $(-1)$ является квадратичным  невычетом в $\mathbb{F}_q$.

**следствие**

Если $p$ — простое и $4|(p^m+1)$, то существует матрица Адамара порядка $(p^m+1)$.

## коды Боуза—Шриханде (коды Адамара)

Пусть $A\in\{0,1\}^{n\times n}$ —  матрица, полученная из нормализованной матрицы Адамара заменой элементов $-1$ на $0$.

- множество строк матрицы $A$ с отброшенной первой координатой образует двоичный $\big(n-1,n,\frac{n}{2}\big)$-код
- множество строк матрицы A и их дополнений образует $\big(n,2n,\frac{n}{2}\big)$-код

На кодах первого типа достигается граница Плоткина.