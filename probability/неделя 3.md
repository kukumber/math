# Схема испытаний Бернулли

Предположим, есть монета со смещенным центром тяжести. При броске монеты она с вероятностью $p\in [0,1]$ ложится кверху решкой, а с вероятностью $q:=1-p$ — орлом.

Зафиксируем некоторое натуральное число $n\in \mathbb{N}$ и будем бросать монетку ровно $n$ раз, каждый раз фиксируя, какой стороной вверх она упала. Если она упала вверх решкой, то будем писать цифру 1 (успех), соответственно, орлом — 0 (неудача). После всех $n$ бросаний монетки возникает некоторая последовательность $\Omega:=\big\{\omega=(x_1, \dots, x_n), x_i \in \{0,1\}\big\}$. Всего таких $\omega$,  то есть $|\Omega|=2^n$.

С какой вероятностью возникает конкретный исход в рамках такой схемы испытаний Бернулли. 
$$P\big(\omega=(x_1, \dots, x_n)\big)$$

Если $x_1$ в этой последовтельности 1, то мы знаем, что она возникает со вполне определенной вероятностью $p$. То же самое с $x_2$. Поскольку бросания монетки были очевидно независимыми, то вероятности двух единиц неоходимо просто перемножить. То есть, в целом вероятность будет равна произведению всех $p$ и $q$.
$$P\big(\omega=(x_1, \dots, x_n)\big)=p^{\sum_{i=1}^nx_i}\times q^{n-\sum_{i=1}^nx_i}$$
Есть один специальный частный случай, когда $p=\frac{1}{2}$, тогда и $q=\frac{1}{2}$. В этом случае 
$$P=\bigg(\frac{1}{2}\bigg)^n=\frac{1}{2^n}$$

Например, рассмотрим событие $A$, состоящее в том, что в $n$ испытаниях Бернулли ровно $k$ успехов.

Как и в классической ситуации, $A$  — это множество элементарных исходов:
$$A=\{\omega_{i_1},\dots,\omega_{i_m} \} \subseteq \Omega$$
Мы должны рассмотреть только те последовательности из 0 и 1, в которых ровно $k$ единиц:
$$A=\{\omega=(x_i,\dots,x_n):x_i \in \{0,1\}, x_1+\ldots+x_n=k \}$$
Тогда $m$ — это то количество векторов, у которых ровно $k$ единиц:
$$m=|A|=C_n^k$$
Таким образом, вероятность события $A$
$$P(A):=\sum_{\omega\in A}P(\omega)=C_n^k\cdot p^k \cdot q^{n-k}$$
вероятность отдельного $\omega$:
$$P(\omega)=p^k\cdot q^{n-k}$$
## Пример

Есть множество $\{1,2,3,\dots,n\}$. Извлечем из этого множества случайное подмножество  $A$, бросая монетку со смещенным центром тяжести с вероятностью успеха $p$. Если в первом бросании эта монетка падает решкой кверху, тогда берем элемент 1 и кладем его в множество $A$, и так далее $n$ раз.
$$P(i\in A)=p$$
Теперь снова берем исходное множество и из него извлекаем новое случайное подмножество $B$ по той же схеме, независимо от множества $A$.

С какой вероятностью эти два независимо выбранных случайных множества вообще не пересекаются?
$$P(A\cap B)=\varnothing$$

Рассмотрим множества $A$ и $B$ как последовательности нулей и единиц, при том, что единица стоит там, где событие случилось успешно, и ноль — неуспешно
$$\begin{aligned}
A=101101011\\
B=010100100
\end{aligned}$$
Нас интересует событие, когда в каждом столбце нет двух единиц.

Вероятность того, что в данном конкретном столбце нет единиц:
$$1-p^2$$
потому как вероятность появления в каждом из множеств на одном и том же месте единицы равна $p$, соответственно в двух множествах — это $p^2$.

Вероятность того, что в *каждом* столбце нет двух единиц:
$$(1-p²)^n$$
# Полиномиальная схема

Допустим, у нас есть $k$ видов исходов $a_1,\dots,a_k$ 
$$P(a_1) = p_1,\dots, P(a_k) = p_k$$
При этом сумма вероятностей должна быть равна единице:
$$\sum_{i=1}^kp_i=1$$
Так, же как и с биномиальной схемой, будет создаваться множество $\omega$ будет наполняться значениями:
$$\omega = (x_1,x_2,\dots,x_n)$$
Это и есть элементарное событие в полиномиальной схеме.

Тогда пространство всех элементарных исходов:
$$\Omega = \big\{\omega=(x_1,x_2,\dots,x_n):\forall i \ x_i\in \{a_1,\dots,a_k\} \big\}$$
Мощность $\Omega$:
$$|\Omega|=k^n$$
Тогда вероятность каждого элементарного исхода
$$P\big(\omega(x_1,\dots,x_n)\big)$$
Пусть $n_1$ элементов конкретного элементарного исхода среди $x_1,\dots,x_n$ равны $a_1$.
Пусть $n_2$ элементов конкретного элементарного исхода среди $x_1,\dots,x_n$ равны $a_2$.
$\dots$
Пусть $n_k$ элементов конкретного элементарного исхода среди $x_1,\dots,x_n$ равны $a_k$.
$$\sum_{i=1}^kn_i=n, \forall i \ n_i \ge 0$$
Тогда вероятность того, что $a_1$ выпадет ровно $n_1$ раз равна $p_1^{n_1}$, и так далее, тогда:
$$P\big(\omega(x_1,\dots,x_n)\big)= P(n_1,\dots,n_k)\cdot p_1^{n_1}\cdot p_2^{n_2} \cdot \ldots \cdot p_k^{n_k}$$
Где справа от знака равно — полиномиальный коэффициент.
