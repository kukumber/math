# математическое ожидание случайно величины

Математическое ожидание случайной величины принято обозначать двумя способами: $M\xi$  и $E\xi$ 
$$M\xi = \sum_{\omega \in \Omega}\xi(\omega)P(\omega)$$
$\xi$ на своем пространстве элементарных исходов принимает $k$ различных значений
$$\xi:\Omega\rightarrow\{y_1,\dots,y_k\}$$
то есть для разных элементарных исходов из множества $\Omega$ $\xi(\omega)$ может равняться одному и тому же числу. Перегруппируем слагаемые, сначала поставим все $\xi(\omega)=y_1$, тогда
$$\begin{aligned}
&=y_1\bigg(\sum_{\omega:\xi(\omega)=y_1}p(\omega)\bigg)+y_2\bigg(\sum_{\omega:\xi(\omega)=y_2}p(\omega)\bigg)+\ldots+y_k\bigg(\sum_{\omega:\xi(\omega)=y_k}p(\omega)\bigg)=\\
\\
&=y_1P\big(\xi(\omega)=y_1\big) + y_2P\big(\xi(\omega)=y_2\big) + \ldots+ y_kP\big(\xi(\omega)=y_k\big) = \\
\\
&= \sum_{j=1}^ky_jP\big(\xi(\omega)=y_j\big)
\end{aligned}$$

# свойство линейности математического ожидания

Если есть две произвольные случайные величины $\xi_1$ и $\xi_2$, определенные на конечном вероятностном пространстве, а $c_1$ и $c_2$ — произвольные вещественные числа, то верно равенство:
$$M(c_1\xi_1+c_2\xi_2)=c_1M\xi_1+c_2M\xi_2$$

## пример 1
Допустим, есть случайная величина $\xi$, которая равна числу треугольников в случайном графе, чему равно $M\xi$?
$$M\xi=\sum_{k=1}^{C_n^3}kP(\xi=k)$$
Посчитать даже вероятность $\xi=1$ мы не имеем возможности.
Пусть у нас есть случайный граф
$$\xi(G)=\xi_1(G)+\ldots+\xi_{C_n^3}(G)$$
где
$$\xi_i(G)=
\begin{cases}
1, \text{if i-th triple of verteces create triangle}\\
0, \text{if no}
\end{cases}$$
замечание, такая случайная величина называется **индикатор**

теперь воспользуемся линейностью:
$$M\xi=M\xi_1+\ldots+M\xi_{C_n^3}$$
посчитать $M\xi_i$ мы можем, потому что нужно посчитать 1, умноженное на вероятность получить 1 и 0 на вероятность получить 0, так как в каждом конкретном случае трех вершин ребро возникает с вероятностью $p$, то вероятность образования треугольника на данных конкретных вершинах равна:
$$M\xi_i=P(\xi_i=1)=p^3$$
теперь можем посчитать окончательное значение
$$M\xi=M\xi_1+\ldots+M\xi_{C_n^3}=C_n^3\cdot p^3$$

## пример 2

Есть схема испытаний Бернулли. Обозначим $\mu_n$ число успехов, каждый из которых случается с вероятностью $p$. По-другому можно сказать, что:
$$\mu_n=\sum_{i=1}^nx_i$$
но $x_i$  — это тоже случайная величина, причем тоже индикаторная:
$$x_i=
\begin{cases}
1, p\\
0, q
\end{cases}$$
таким образом математическое ожидание будет равно
$$M\mu_n=np$$

# неравенство Маркова

Пусть $\xi$ принимает только неотрицательные значения. Пусть $a>0$. Тогда
$$P(\xi\ge a)\le \frac{M\xi}{a}$$
доказательство

Так как
$$M\xi=\sum_{j=1}^ky_jP(\xi=y_j)=$$
разобьем сумму на две части: в одной будут находиться только те $j$, для которых $y_j\ge a$,
$$=\sum_{j:y_j\ge a}y_jP(\xi=y_j)+\sum_{j:y_j<a}y_jP(\xi=y_j)=$$
заметим, что $y_j \ge 0$, потому что $\xi$ по условию принимает только неотрицательные значения, вероятность — неотрицательна, значит вся сумма — неотрицательна. Тогда вся эта сумма:
$$=\sum_{j:y_j\ge a}y_jP(\xi=y_j)+\sum_{j:y_j<a}y_jP(\xi=y_j)\ge \sum_{j:y_j\ge a}y_jP(\xi=y_j)\ge a \sum_{j:y_j\ge a}y_jP(\xi=y_j)$$
в итоге получаем
$$=aP(\xi\ge a)$$
а значит
$$P(\xi\ge a)\le \frac{M\xi}{a}$$
## применение

Пусть число вершин случайного графа растет к бесконечности. Пусть вероятность с которой мы проводим каждое ребро графа $p$ — это тоже функция, которая при каждом $n$ принимает свое отдельное значение
$$p=p(n)$$
причем, эта функция стремится к нулю
$$np(n)\xrightarrow[n\rightarrow\infty]{}0$$
То есть вероятность возникновения ребра бесконечно мала по сравнению с $1/n$ или $1/n^2$. Тогда вероятность того, что в графе нет треугольников стремится к единице:
$$P(\xi=0)\xrightarrow[n\rightarrow\infty]{}1$$
Доказательство:
$$P(\xi=0)=1-P(\xi\ge1)$$
$\xi$ принимает неотрицательные значения, 1 — положительное число, поэтому, согласно неравенству Маркова:
$$P(\xi\ge1)\le M\xi$$значит разность
$$P(\xi=0)=1-P(\xi\ge1)\ge 1 - M\xi=1-C_n^3\cdot p^3$$
что такое $C_n^3\cdot p^3$
$$C_n^3\cdot p^3=\frac{n(n-1)(n-2)}{6}p^3$$
произведение в числителе асимптотически равно $n^3$
$$C_n^3\cdot p^3=\frac{n(n-1)(n-2)}{6}p^3\sim \frac{n^3p^3}{6}$$
как было сказано выше, $np(n)\xrightarrow[n\rightarrow\infty]{}0$, значит и числитель в выражении стремится к нулю
$$C_n^3\cdot p^3=\frac{n(n-1)(n-2)}{6}p^3\sim \frac{n^3p^3}{6}\xrightarrow[n\rightarrow\infty]{}0$$
то есть математическое ожидание стремится к нулю, а разность — к единице.

# дисперсия

Дисперсия $D\xi$ случайной величины, это среднеквадратичное отклонение случайной величины от своего среднего значения:
$$D\xi:=M(\xi-M\xi)^2$$
показывает на сколько сильно значения случайной величины разбросаны вокруг среднего значения.

Если воспользоваться свойством линейности:
$$M(\xi-M\xi)^2=M\big(\xi²-2\xi M\xi+(M\xi)^2\big)=M\xi^2-2M\xi M\xi+M\xi^2=M\xi^2-(M\xi)^2$$

# неравенство Чебышёва

Пусть $\eta$ — это любая случайная величина. Пусть $b>0$, тогда вероятность 
$$P(|\eta-M\eta|\ge b)\le \frac{D\eta}{b^2}$$
Доказательство:
В неравенстве Маркова положим $\xi = (\eta-M\eta)^2 \ge 0$, $a=b^2$, тогда
$$P(\xi \ge a)\le \frac{M\xi}{a}$$
то есть
$$P\big((\eta-M\eta)^2\ge b^2\big)\le \frac{M(\eta-M\eta)^2}{b^2}$$
в числителе оказывается дисперсия
$$P\big((\eta-M\eta)^2\ge b^2\big)\le \frac{D\eta}{b^2}$$

## пороговая вероятность

Вернемся к задаче про треугольники. Пусть $n$ теперь растет к бесконечности и $p=p(n)$ и 
$$np(n)\rightarrow +\infty$$
Тогда
$$P(\xi\ge 1)\xrightarrow[n\to\infty]{} 1$$
Доказательство:
$$P(\xi\ge 1)= 1 - P(\xi \le 0)=$$
домножим слева и справа на -1
$$=1-P(-\xi\ge 0)=$$
добавим слева и справа одну и ту же константу $M\xi$
$$=1 -P(M\xi-\xi\ge M\xi)=$$
вероятность того, что случайная величина достаточно большая не больше того, что модуль этой случайной величины достаточно велик:
$$P(M\xi-\xi\ge M\xi)\le P\big(|M\xi-\xi|\ge M\xi\big)$$
тогда предыдущее равенство можно переписать как
$$=1 -P(M\xi-\xi\ge M\xi)\ge 1- P\big(|M\xi-\xi|\ge M\xi\big)$$
теперь к вероятности применяем неравенство Чебышёва
$$1 -P(M\xi-\xi\ge M\xi)\ge 1- P\big(|M\xi-\xi|\ge M\xi\big)\le\frac{D\xi}{(M\xi)^2}\ge 1-\frac{D\xi}{(M\xi)^2}$$
Достаточно доказать, что правая дробь стремится к нулю. По второй формуле
$$D\xi=M\xi^2-(M\xi)^2$$
Представим $\xi$ в виде суммы индикаторов:
$$M\xi^2=M\big(\xi_1+\ldots+\xi_{C_n^3}\big)^2=M\big(\xi_1^2+\ldots+\xi_{C_n^3}^2 + \sum_{i\ne j}\xi_i\xi_j\big)=$$
по определению $\xi_i$
$$\xi_i=
\begin{cases}
1, p\\
0, q
\end{cases}$$
так как это индикатор, то от возведения его в квадрат ничего не меняется, то есть
$$=M\big(\xi_1+\ldots+\xi_{C_n^3} + \sum_{i\ne j}\xi_i\xi_j\big)=$$
тогда левая часть — это известное произведение
$$C_n^3\cdot n^3$$
необходимо найти только под знаком суммы
$$\sum_{i\ne j}M\xi_i\xi_j$$
понятно, что произведение $\xi_i\xi_j=1$ только в том случае, если $i$ и $j$ тройки вершин образуют треугольники в графе (событие $A$) и 0 — во всех остальных случах, тогда
$$M\xi_i\xi_j=P(A)$$
Пересечение троек вершин $i$ и $j$ может иметь следующие варианты:
- нет общих вершин
- одна общая вершина
- две общие вершины

В первом случае, вероятность появления шести граней — $p^6$.
Во втором случае — $p^6$ 
В третьем случае — $p^5$.

Таким образом, сумма
$$\sum_{i\ne j}M\xi_i\xi_j=(C_n^3\cdot C_{n-3}^3+C_n^3\cdot 3\cdot C_{n-3}^2) p^6+C_n^3\cdot 3(n-3)p^5$$
теперь можно вернуться к дроби
$$\frac{D\xi}{(M\xi)^2}=\frac{1}{M\xi}+\frac{C_n^3\cdot C_{n-3}^3+C_n^3\cdot 3\cdot C_{n-3}^2\cdot p^6+C_n^3\cdot 3(n-3)p^5}{(C_n^3p^3)^2}-1$$
так как
$$M\xi=C_n^3p^3\sim\frac{n^3p^3}{6}$$
так как $np$ стремится к бесконечности, математическое ожидание тоже стремится к бесконечности, то есть первое слагаемое нашей суммы стремится к нулю.

Первая часть числителя:
$$\frac{(C_n^3\cdot C_{n-3}^3) p^6}{(C_n^3)^2p^6}=\frac{C_{n-3}^3}{C_n^3}\sim1$$
вторая часть числителя
$$\frac{3C_n^3\cdot C_{n-3}² p^6}{(C_n^3)^2p^6}\sim 0$$
последняя часть
$$\frac{3C_n^3(n-3) p^5}{(C_n^3)^2p^6}=\frac{3(n-3)}{C_n^3p}\sim 0$$
получается, что вся сумма стремится к нулю.
